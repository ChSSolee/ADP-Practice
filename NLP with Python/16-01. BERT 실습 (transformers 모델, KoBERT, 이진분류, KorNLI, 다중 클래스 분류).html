<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>16-01. BERT 실습 (transformers 모델, KoBERT, 이진분류, KorNLI, 다중 클래스 분류)</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 15px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 110em;
      padding-left: 2px;
      padding-right: 10px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="16-01-bert-실습" class="cell markdown" id="uiZq6kSO_VVy">
<h1>16-01. BERT 실습</h1>
<p><br></p>
<h4 id="tpu-초기화">TPU 초기화</h4>
</section>
<div class="cell code" id="Sxa-9J8h_d2V">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:16173,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010746192,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="zMZB6G6I_bfW" data-outputId="88ed3439-6c83-4058-bc5e-50382a359f48">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>resolver <span class="op">=</span> tf.distribute.cluster_resolver.TPUClusterResolver(tpu<span class="op">=</span><span class="st">&#39;grpc://&#39;</span> <span class="op">+</span> os.environ[<span class="st">&#39;COLAB_TPU_ADDR&#39;</span>])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tf.config.experimental_connect_to_cluster(resolver)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tf.tpu.experimental.initialize_tpu_system(resolver)</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<pre><code>&lt;tensorflow.python.tpu.topology.Topology at 0x78af77bfea10&gt;</code></pre>
</div>
</div>
<section id="tpu-strategy-셋팅" class="cell markdown" id="Zibp-isx_bcR">
<h4>TPU Strategy 셋팅</h4>
<ul>
<li><code>tf.distribute.Strategy</code>는 훈련을 여러 GPU 또는 여러
장비, 여러 TPU로 나누어 처리하기 위한 텐서플로 API</li>
<li>이 API를 사용하면 기존의 모델이나 훈련 코드를 분산처리를 할 수
있음</li>
</ul>
</section>
<div class="cell code" id="HPc3JWuJ_bZW">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>strategy <span class="op">=</span> tf.distribute.TPUStrategy(resolver)</span></code></pre></div>
</div>
<div class="cell markdown" id="HxQ9wBAu_bWn">
<p><br></p>
<h4 id="딥-러닝-모델의-컴파일">딥 러닝 모델의 컴파일</h4>
<ul>
<li>모델의 컴파일은 <code>strategy.scope</code> 내에서 이루어져야
함</li>
<li>이는 모델의 층을 쌓는 <code>create_model()</code>와 같은 함수를
만들어 <code>strategy.scope</code> 내에서 해당 함수를 호출하여 모델을
컴파일하는 방식으로 할 수 있음</li>
</ul>
</div>
<div class="cell markdown" id="xVcPHztp_8qH">
<p><br></p>
<ul>
<li>모델의 층을 쌓는 <code>create_model()</code>라는 함수에 대해서</li>
</ul>
</div>
<div class="cell code" id="j6NAuuTZ_8mq">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_model():</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> tf.keras.Sequential(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>      [tf.keras.layers.Conv2D(<span class="dv">256</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, input_shape<span class="op">=</span>(<span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>       tf.keras.layers.Conv2D(<span class="dv">256</span>, <span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>       tf.keras.layers.Flatten(),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>       tf.keras.layers.Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>       tf.keras.layers.Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>       tf.keras.layers.Dense(<span class="dv">10</span>)])</span></code></pre></div>
</div>
<div class="cell markdown" id="cPYHwEdS_8jx">
<ul>
<li><p><code>with strategy.scope():</code> 다음에 들여쓰기를 하고,</p>
<p><span class="math inline">→</span> <code>create_model()</code> 함수를
호출하고 모델을 컴파일</p>
<p><strong>다시 말해 strategy.scope 내에서 모델을
컴파일</strong></p></li>
<li><p>이 모델을 fit() 하게되면 해당 모델은 TPU를 사용하며 학습</p></li>
<li><p>위의 1~3번까지의 코드를 실행하고, BERT와 커스텀 레이어에 대한
모델의 컴파일을 <code>strategy.scope</code> 내에서 진행</p></li>
</ul>
</div>
<div class="cell code" id="dYYI6ngV_8gy">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> strategy.scope():</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> create_model()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                loss<span class="op">=</span>tf.keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                metrics<span class="op">=</span>[<span class="st">&#39;sparse_categorical_accuracy&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="8kJLdoqoAKBH">
<p><br></p>
<h4 id="gpu-실습-코드로-되돌리기">GPU 실습 코드로 되돌리기</h4>
<ul>
<li><p>TPU로 실행한 코드들을 GPU 환경에서 실행하고 싶다면,</p>
<p>모델의 층을 쌓고, 컴파일하는 코드를 제외한 TPU 진행만을 위한 코드들을
전부 제거</p></li>
</ul>
</div>
<div class="cell markdown" id="7TFDgpyoAJ-P">
<p><br></p>
<h2 id="transformers의-모델-클래스-불러오기"><code>transformers</code>의
모델 클래스 불러오기</h2>
<ul>
<li><code>transformers</code> 라이브러리에서는 각종 태스크에 맞게 BERT
위에 출력층을 추가한 모델 클래스 구현체를 제공</li>
<li>아래의 구현체를 사용하면 사용자가 별도의 출력층을 설계할 필요없이
태스크에 맞게 모델을 로드하여 사용할 수 있음</li>
</ul>
</div>
<div class="cell markdown" id="HNGRve1MAnhR">
<p><br></p>
<h3 id="다-대-일-유형">다 대 일 유형</h3>
<ul>
<li><strong>다 대 일(many-to-one) 유형은 텍스트 분류에 주로 사용되는
모델</strong></li>
</ul>
<p><br></p>
<h4
id="transformerstfbertforsequenceclassificationfrom_pretrained모델-이름-num_labels분류할-레이블의-개수"><code>transformers.TFBertForSequenceClassification.from_pretrained("모델 이름", num_labels="분류할 레이블의 개수")</code></h4>
</div>
<div class="cell markdown" id="dFw3PqPYAndM">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> TFBertForSequenceClassification</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TFBertForSequenceClassification.from_pretrained(<span class="st">&quot;모델 이름&quot;</span>, num_labels<span class="op">=</span><span class="st">&quot;분류할 레이블의 개수&quot;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="INR5agrOAnZe">
<p><br></p>
<h3 id="다-대-다-유형">다 대 다 유형</h3>
<ul>
<li><p><strong>다 대 다(many-to-one) 유형은 다수의 입력에 대해서 다수의
출력이 필요할 때 사용하는 모델</strong></p>
<p><span class="math inline">→</span> 개체명 인식</p></li>
</ul>
<p><br></p>
<h4
id="transforemrstfbertfortokenclassificationfrom_pretrained모델-이름-num_labels분류할-레이블의-개수"><code>transforemrs.TFBertForTokenClassification.from_pretrained("모델 이름", num_labels="분류할 레이블의 개수")</code></h4>
</div>
<div class="cell markdown" id="b5JwjLJfAnWi">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> TFBertForTokenClassification</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TFBertForTokenClassification.from_pretrained(<span class="st">&quot;모델 이름&quot;</span>, num_labels<span class="op">=</span><span class="st">&quot;분류할 레이블의 개수&quot;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="MeiwFczZBP9Z">
<p><br></p>
<h3 id="질의-응답-유형">질의 응답 유형</h3>
<ul>
<li><p><strong>질의 응답(Question Answering) 문제를 풀기 위해 사용하는
모델</strong></p>
<p><span class="math inline">→</span> 기계 독해</p></li>
</ul>
<p><br></p>
<h4
id="transformers-tfbertforquestionansweringfrom_pretrained모델-이름"><code>transformers .TFBertForQuestionAnswering.from_pretrained('모델 이름')</code></h4>
<p><br></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> TFBertForQuestionAnswering</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TFBertForQuestionAnswering.from_pretrained(<span class="st">&#39;모델 이름&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="RRNeYAQAAJ6z">
<p><br></p>
<h2 id="google-bert를-이용한-네이버-영화-리뷰-분류">Google BERT를 이용한
네이버 영화 리뷰 분류</h2>
</div>
<div class="cell code" id="h7TPztkdcdLO">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pip install transformers</span></code></pre></div>
</div>
<div class="cell code" id="nY4HfcDXikCI">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> transformers</span></code></pre></div>
</div>
<div class="cell code" id="HPC7cPCrnF0q">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> BertTokenizer, TFBertModel</span></code></pre></div>
</div>
<div class="cell markdown" id="bViXZxQpBoWs">
<ul>
<li>데이터 로드</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1001,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010768922,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="QYbuNR1tdJca" data-outputId="3b1e01e6-50c7-4389-8f5d-9462f180c8d9">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/e9t/nsmc/master/ratings_train.txt&quot;</span>, filename<span class="op">=</span><span class="st">&quot;ratings_train.txt&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/e9t/nsmc/master/ratings_test.txt&quot;</span>, filename<span class="op">=</span><span class="st">&quot;ratings_test.txt&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>(&#39;ratings_test.txt&#39;, &lt;http.client.HTTPMessage at 0x78aea721bd30&gt;)</code></pre>
</div>
</div>
<div class="cell code" id="opGrZfOseqRi">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> pd.read_table(<span class="st">&#39;ratings_train.txt&#39;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_table(<span class="st">&#39;ratings_test.txt&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010769513,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="aiF5GOyxelOY" data-outputId="700f404c-cfef-460a-b41d-c3e907f73ea8">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;훈련용 리뷰 개수 :&#39;</span>,<span class="bu">len</span>(train_data)) <span class="co"># 훈련용 리뷰 개수 출력</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>훈련용 리뷰 개수 : 150000
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010769513,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="ZfefWt-2eoDS" data-outputId="ead6d701-4ad3-4e2f-acec-32e2a01476ea">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;테스트용 리뷰 개수 :&#39;</span>,<span class="bu">len</span>(test_data)) <span class="co"># 테스트용 리뷰 개수 출력</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>테스트용 리뷰 개수 : 50000
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:224}"
data-executionInfo="{&quot;elapsed&quot;:576,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010770087,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="vvzQl1j7eqhS" data-outputId="97dae5fd-ee12-40b4-c976-ad4a0a0364ab">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>train_data[:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">

  <div id="df-47d18ebe-7cf4-4877-8ef9-6d2f9e5d6866" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>document</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9976970</td>
      <td>아 더빙.. 진짜 짜증나네요 목소리</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3819312</td>
      <td>흠...포스터보고 초딩영화줄....오버연기조차 가볍지 않구나</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10265843</td>
      <td>너무재밓었다그래서보는것을추천한다</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9045019</td>
      <td>교도소 이야기구먼 ..솔직히 재미는 없다..평점 조정</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6483659</td>
      <td>사이몬페그의 익살스런 연기가 돋보였던 영화!스파이더맨에서 늙어보이기만 했던 커스틴 ...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-47d18ebe-7cf4-4877-8ef9-6d2f9e5d6866')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-47d18ebe-7cf4-4877-8ef9-6d2f9e5d6866 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-47d18ebe-7cf4-4877-8ef9-6d2f9e5d6866');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0f6c483d-2c10-4cd0-a0d4-fe04ac9ac6e5">
  <button class="colab-df-quickchart" onclick="quickchart('df-0f6c483d-2c10-4cd0-a0d4-fe04ac9ac6e5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0f6c483d-2c10-4cd0-a0d4-fe04ac9ac6e5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:224}"
data-executionInfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010770088,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="W9ppfuX4erVK" data-outputId="c8d5e5f9-211c-4ddd-a901-aee0f9e999b0">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>test_data[:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">

  <div id="df-6d37c8e6-d48a-4a7b-a1fb-0026d4543fb7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>document</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6270596</td>
      <td>굳 ㅋ</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9274899</td>
      <td>GDNTOPCLASSINTHECLUB</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8544678</td>
      <td>뭐야 이 평점들은.... 나쁘진 않지만 10점 짜리는 더더욱 아니잖아</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6825595</td>
      <td>지루하지는 않은데 완전 막장임... 돈주고 보기에는....</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6723715</td>
      <td>3D만 아니었어도 별 다섯 개 줬을텐데.. 왜 3D로 나와서 제 심기를 불편하게 하죠??</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6d37c8e6-d48a-4a7b-a1fb-0026d4543fb7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6d37c8e6-d48a-4a7b-a1fb-0026d4543fb7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6d37c8e6-d48a-4a7b-a1fb-0026d4543fb7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f3664a90-0a06-44de-9703-db376e261049">
  <button class="colab-df-quickchart" onclick="quickchart('df-f3664a90-0a06-44de-9703-db376e261049')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f3664a90-0a06-44de-9703-db376e261049 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="a4tJoEsKBsMR">
<ul>
<li>데이터 정제</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010770088,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="vWSh9Lc-esFC" data-outputId="cb0a899e-57a5-4424-c31b-0a8449a033c8">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.dropna(how <span class="op">=</span> <span class="st">&#39;any&#39;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.isnull().values.<span class="bu">any</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010770088,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="tAgd9TbRetIa" data-outputId="30c680fb-83ea-4f02-c7fd-dcfc0e4753d8">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> test_data.dropna(how <span class="op">=</span> <span class="st">&#39;any&#39;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> test_data.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data.isnull().values.<span class="bu">any</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010770088,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Q2qLL0Jpet8C" data-outputId="1f1a5827-69bc-46b1-f177-76f949bfd792">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(train_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>149995
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010770088,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="08SqlJG4euuq" data-outputId="b52552bc-12cc-46f6-c226-2f20097307bd">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(test_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>49997
</code></pre>
</div>
</div>
<div class="cell markdown" id="-QDMV070BvBw">
<p><br></p>
<h4 id="토크나이저-생성">토크나이저 생성</h4>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:331,&quot;referenced_widgets&quot;:[&quot;d7eda99de6e747b88bd7502f90d19e4b&quot;,&quot;35ce5f910c07470ba363d61f9cc6cd1e&quot;,&quot;838268c222c44bd59ad48f10852ee6a5&quot;,&quot;bb64abcaf0204dff99b4b086a5e5d0e6&quot;,&quot;7f1ec2d2484a44b6b5fd7282dcf9591b&quot;,&quot;84c5403d28ac4ba0b99b670be28a556b&quot;,&quot;6bf735e8f69b4299898fe67d0ef868f5&quot;,&quot;bef44fbc8abc4cc5ac419fe4d926f43e&quot;,&quot;603cd168475a4eb292e7e7e31831ee6d&quot;,&quot;3420918c618d4f03b6d09ea4fdfd70b8&quot;,&quot;6086b4c8995c47eb9685c5a4c5b22cf9&quot;,&quot;45a0d013bb2643d9a3bc75a3888a3162&quot;,&quot;8957c674e30a4359b399254bef0d7d2a&quot;,&quot;10d7a4ea2f884eb295ea866d5e686fdf&quot;,&quot;bc34eb89fad44d8b980cb7ca550cca61&quot;,&quot;b6adfa5c760a468d92688cbcf5f08681&quot;,&quot;e9e8ea08570240d4ab38e4cf13c74885&quot;,&quot;24a2d8a027114616a53c116714885f37&quot;,&quot;be82b78437214e21a92c34dc39e14b27&quot;,&quot;ecc222314b87479cb9f3a5e27f1245e1&quot;,&quot;315ac04bb63747b9ace018056cdaa810&quot;,&quot;153b2204ce0d4fe389667b92ade778c4&quot;,&quot;9cbbc6acdb3448c7a4984793abb593d4&quot;,&quot;05e48900433147439117cf0a5140b32d&quot;,&quot;b9f0dca3a3a14cc8b7524b7a4b5582ef&quot;,&quot;928c08c100a44b9681ad9f9737c33a60&quot;,&quot;bd703e3824524bb88edd93981941b872&quot;,&quot;a9e1060c955f4c619f5dfe56f974a415&quot;,&quot;2093676567924971857f83c20a3d3f82&quot;,&quot;3bd7d5b53d384469ae00fb03e947737d&quot;,&quot;3ccd37db487e4703be7d721284247c66&quot;,&quot;6fcc2af579f141b88e1826cb5277b11e&quot;,&quot;b4528e2345fa4185abeada4f19284807&quot;,&quot;4af0e75710c1414dad4e6cc405f9fc95&quot;,&quot;79d69266b21c45be98829171c2335144&quot;,&quot;b1ee65dbf3c741ca9e9a7364fcd7411c&quot;,&quot;119608b5e5264b49a0e0ca6bd921a7f0&quot;,&quot;4135723cd7944990bdec3990fc6e6254&quot;,&quot;971923fc54da41f8861331e77ab24697&quot;,&quot;522e825e8dc34ed79f3daf9c51ebc909&quot;,&quot;8153a2d659bd42f8bc1e0d378aa95419&quot;,&quot;d6eb6eb3a01f4a3db8348a3f5dea6c9a&quot;,&quot;8d8ea5fa87c747baad58ccaadddd8585&quot;,&quot;0cc49ec76aaf4551bd5e466265956ddf&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:3454,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773537,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Nx_D1rlXfcB6" data-outputId="1080f797-bf1d-4528-bd31-0d0ec313b681">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> BertTokenizer.from_pretrained(<span class="st">&#39;bert-base-multilingual-cased&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
</code></pre>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb32"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d7eda99de6e747b88bd7502f90d19e4b&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb33"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;45a0d013bb2643d9a3bc75a3888a3162&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb34"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;9cbbc6acdb3448c7a4984793abb593d4&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb35"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;4af0e75710c1414dad4e6cc405f9fc95&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell markdown" id="1TwdB-5qB8gn">
<ul>
<li>토크나이저 확인</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773537,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="gHigtMypgOKz" data-outputId="060187a7-e9dd-4be2-9289-375a0b55c3cf">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.encode(<span class="st">&quot;보는내내 그대로 들어맞는 예측 카리스마 없는 악역&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[101, 9356, 11018, 31605, 31605, 110589, 71568, 118913, 11018, 9576, 119281, 9786, 79940, 23811, 40364, 9520, 23160, 102]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773538,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="r47lhT54gmeD" data-outputId="0b5da64f-9cf5-480f-b4e2-de8054e73de8">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.tokenize(<span class="st">&quot;보는내내 그대로 들어맞는 예측 카리스마 없는 악역&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;보&#39;, &#39;##는&#39;, &#39;##내&#39;, &#39;##내&#39;, &#39;그대로&#39;, &#39;들어&#39;, &#39;##맞&#39;, &#39;##는&#39;, &#39;예&#39;, &#39;##측&#39;, &#39;카&#39;, &#39;##리스&#39;, &#39;##마&#39;, &#39;없는&#39;, &#39;악&#39;, &#39;##역&#39;]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:35}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773538,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="XIDFM-jEkKft" data-outputId="b9ec1879-c562-41c2-ce74-26b60784e099">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tokenizer.decode(tokenizer.encode(<span class="st">&quot;보는내내 그대로 들어맞는 예측 카리스마 없는 악역&quot;</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">
<div class="sourceCode" id="cb41"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773538,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="crCnp1NWkGQu" data-outputId="09d409d7-1796-490d-d57a-afee1d68f7a8">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elem <span class="kw">in</span> tokenizer.encode(<span class="st">&quot;보는내내 그대로 들어맞는 예측 카리스마 없는 악역&quot;</span>):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(tokenizer.decode(elem))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[ C L S ]
보
# # 는
# # 내
# # 내
그 대 로
들 어
# # 맞
# # 는
예
# # 측
카
# # 리 스
# # 마
없 는
악
# # 역
[ S E P ]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773538,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="kHO4iiqQhP6D" data-outputId="0b51e684-dc69-4b39-e390-a621cbbbe3f6">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.tokenize(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;전&#39;, &#39;##율&#39;, &#39;##을&#39;, &#39;일&#39;, &#39;##으&#39;, &#39;##키는&#39;, &#39;영화&#39;, &#39;.&#39;, &#39;다시&#39;, &#39;보고&#39;, &#39;##싶&#39;, &#39;##은&#39;, &#39;영화&#39;]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773538,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="PTL9qUrvhRHz" data-outputId="a41f9976-9fd5-4453-9c28-2537bc0e51fd">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.encode(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[101, 9665, 119183, 10622, 9641, 119185, 66815, 42428, 119, 25805, 98199, 119088, 10892, 42428, 102]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010773538,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="vaFHN_zahR4i" data-outputId="976bd421-82c7-4101-bcf9-823ecf4b6bd4">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elem <span class="kw">in</span> tokenizer.encode(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>):</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(tokenizer.decode(elem))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[ C L S ]
전
# # 율
# # 을
일
# # 으
# # 키 는
영 화
.
다 시
보 고
# # 싶
# # 은
영 화
[ S E P ]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:20,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774159,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="aOmogNVXhS1S" data-outputId="610919d5-dea4-4693-f294-0c48885fc55c">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elem <span class="kw">in</span> tokenizer.encode(<span class="st">&quot;happy birthday~!&quot;</span>):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(tokenizer.decode(elem))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[ C L S ]
h a p p y
b i r t h d a y
~
!
[ S E P ]
</code></pre>
</div>
</div>
<div class="cell markdown" id="XDPQv-O8CAxZ">
<ul>
<li>문장 시작 토큰 [CLS]와 문장 구분 토큰 [SEP]의 토큰 아이디</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:19,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774159,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Z3WINg5UhTzq" data-outputId="4a8e6550-8b53-4999-bd7c-767f2e25e1af">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.decode(<span class="dv">101</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[ C L S ]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:17,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774159,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="-EM6Nw-LhUqq" data-outputId="97175c58-5a5e-4e32-ecc3-00948f4de211">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.decode(<span class="dv">102</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[ S E P ]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:16,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="9fqNEYEgllB7" data-outputId="afc8d040-1f0b-4884-f355-1b66d3295c1d">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.cls_token, <span class="st">&#39;:&#39;</span>, tokenizer.cls_token_id)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.sep_token, <span class="st">&#39;:&#39;</span> , tokenizer.sep_token_id)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[CLS] : 101
[SEP] : 102
</code></pre>
</div>
</div>
<div class="cell markdown" id="HZbna18SCK0i">
<ul>
<li>패딩 토큰 [PAD]의 토큰 아이디</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:14,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="XFPXfrnomB_q" data-outputId="a86085ad-9c18-4b8d-d8bf-f75dde5467dc">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.pad_token, <span class="st">&#39;:&#39;</span>, tokenizer.pad_token_id)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[PAD] : 0
</code></pre>
</div>
</div>
<div class="cell markdown" id="HeQ5pbOrCN4k">
<p><br></p>
<h4 id="패딩">패딩</h4>
<ul>
<li>문장 최대 길이만큼 패딩</li>
</ul>
</div>
<div class="cell code" id="VhPmUfylhVRy">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>max_seq_len <span class="op">=</span> <span class="dv">128</span></span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:12,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="GDnicNWphV-y" data-outputId="e50f8a4f-9903-4cbe-f2f7-b59b2c9aa23b">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>encoded_result <span class="op">=</span> tokenizer.encode(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>, max_length<span class="op">=</span>max_seq_len, pad_to_max_length<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation=True` to explicitly truncate examples to max length. Defaulting to &#39;longest_first&#39; truncation strategy. If you encode pairs of sequences (GLUE-style) with the tokenizer you can select this strategy more precisely by providing a specific strategy to `truncation`.
/usr/local/lib/python3.10/dist-packages/transformers/tokenization_utils_base.py:2614: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding=&#39;longest&#39;` to pad to the longest sequence in the batch, or use `padding=&#39;max_length&#39;` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).
  warnings.warn(
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="-JXA_4qbRvCr" data-outputId="c368bf40-96b3-482e-fb2a-85d301cc7208">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(encoded_result)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;길이 :&#39;</span>, <span class="bu">len</span>(encoded_result))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[101, 9665, 119183, 10622, 9641, 119185, 66815, 42428, 119, 25805, 98199, 119088, 10892, 42428, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
길이 : 128
</code></pre>
</div>
</div>
<div class="cell markdown" id="FAdd1IMxSyXy">
<p><br></p>
<h4 id="어텐션-마스크-attention-mask">어텐션 마스크 (Attention
Mask)</h4>
<p><img src='https://wikidocs.net/images/page/115055/%EA%B7%B8%EB%A6%BC11.PNG'></p>
<ul>
<li><p>BERT를 실제로 실습하게 되면 어텐션 마스크라는 시퀀스 입력이
추가로 필요</p></li>
<li><p>어텐션 마스크는 BERT가 어텐션 연산을 할 때, 불필요하게 패딩
토큰에 대해서 어텐션을 하지 않도록,</p>
<p>실제 단어와 패딩 토큰을 구분할 수 있도록 알려주는 입력</p>
<p>0과 1 두 가지 값을 가짐</p>
<ul>
<li><p>숫자 1 : 해당 토큰은 실제 단어이므로 마스킹을 하지 않는다라는
의미</p></li>
<li><p>숫자 0 : 해당 토큰은 패딩 토큰이므로 마스킹을 한다는
의미</p></li>
</ul></li>
<li><p>위의 그림과 같이 실제 단어의 위치에는 1, 패딩 토큰의 위치에는 0의
값을 가지는 시퀀스를 만들어 BERT의 또 다른 입력으로 사용</p></li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="yiHWeEAHTFGE" data-outputId="1eb3006f-81e1-4d2e-bcdd-6dc69474344c">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>valid_num <span class="op">=</span> <span class="bu">len</span>(tokenizer.encode(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(valid_num)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.encode(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenizer.decode(tokenizer.encode(<span class="st">&quot;전율을 일으키는 영화. 다시 보고싶은 영화&quot;</span>)))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>15
[101, 9665, 119183, 10622, 9641, 119185, 66815, 42428, 119, 25805, 98199, 119088, 10892, 42428, 102]
[CLS] 전율을 일으키는 영화. 다시 보고싶은 영화 [SEP]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="-z_odn7QhXzK" data-outputId="91d2b91a-a9db-4d24-96dd-0236e785382b">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(valid_num <span class="op">*</span> [<span class="dv">1</span>] <span class="op">+</span> (max_seq_len <span class="op">-</span> valid_num) <span class="op">*</span> [<span class="dv">0</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
</div>
</div>
<div class="cell markdown" id="kN-drzf8WQs3">
<p><br></p>
<h4 id="세그먼트-임베딩">세그먼트 임베딩</h4>
<p><img src='https://wikidocs.net/images/page/115055/%EA%B7%B8%EB%A6%BC7.PNG'></p>
<ul>
<li><p>문장 구분을 위해서 BERT는 세그먼트 임베딩이라는 또 다른 임베딩
층(Embedding layer)을 사용</p></li>
<li><p>첫번째 문장에는 Sentence 0 임베딩, 두번째 문장에는 Sentence 1
임베딩을 더해주는 방식이며, 임베딩 벡터는 두 개만 사용</p>
<p><span class="math inline">→</span> <strong>1개의 입력 문장에 대한
텍스트 분류이기에, 모든 임베딩 값을 0으로 통일</strong></p></li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010774160,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="QDIS8VhmWpW_" data-outputId="62f33dc1-b3da-4c4c-f93a-41bff3bcd391">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>([<span class="dv">0</span>] <span class="op">*</span> max_seq_len)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
</div>
</div>
<div class="cell markdown" id="Bu9PB8Z2VHZj">
<p><br></p>
<h4
id="인코딩된-텍스트에의-어텐션-마스킹-rightarrow-세그먼트-임베딩-생성을-하는-함수">인코딩된
텍스트에의 어텐션 마스킹 <span class="math inline">→</span> 세그먼트
임베딩 생성을 하는 함수</h4>
</div>
<div class="cell code" id="qk8DJZ_khYgK">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_examples_to_features(examples, labels, max_seq_len, tokenizer):</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    input_ids, attention_masks, token_type_ids, data_labels <span class="op">=</span> [], [], [], []</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> example, label <span class="kw">in</span> tqdm(<span class="bu">zip</span>(examples, labels), total<span class="op">=</span><span class="bu">len</span>(examples)):</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># input_id는 워드 임베딩을 위한 문장의 정수 인코딩</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>        input_id <span class="op">=</span> tokenizer.encode(example, max_length<span class="op">=</span>max_seq_len, pad_to_max_length<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># attention_mask는 실제 단어가 위치하면 1, 패딩의 위치에는 0인 시퀀스.</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        padding_count <span class="op">=</span> input_id.count(tokenizer.pad_token_id)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>        attention_mask <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (max_seq_len <span class="op">-</span> padding_count) <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> padding_count</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># token_type_id는 세그먼트 임베딩을 위한 것으로 이번 예제는 문장이 1개이므로 전부 0으로 통일.</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>        token_type_id <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> max_seq_len</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> <span class="bu">len</span>(input_id) <span class="op">==</span> max_seq_len, <span class="st">&quot;Error with input length </span><span class="sc">{}</span><span class="st"> vs </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(<span class="bu">len</span>(input_id), max_seq_len)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> <span class="bu">len</span>(attention_mask) <span class="op">==</span> max_seq_len, <span class="st">&quot;Error with attention mask length </span><span class="sc">{}</span><span class="st"> vs </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(<span class="bu">len</span>(attention_mask), max_seq_len)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> <span class="bu">len</span>(token_type_id) <span class="op">==</span> max_seq_len, <span class="st">&quot;Error with token type length </span><span class="sc">{}</span><span class="st"> vs </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(<span class="bu">len</span>(token_type_id), max_seq_len)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>        input_ids.append(input_id)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>        attention_masks.append(attention_mask)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>        token_type_ids.append(token_type_id)</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>        data_labels.append(label)</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> np.array(input_ids, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>    attention_masks <span class="op">=</span> np.array(attention_masks, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>    token_type_ids <span class="op">=</span> np.array(token_type_ids, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>    data_labels <span class="op">=</span> np.asarray(data_labels, dtype<span class="op">=</span>np.int32)</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (input_ids, attention_masks, token_type_ids), data_labels</span></code></pre></div>
</div>
<div class="cell markdown" id="5k5izDQyVW4G">
<p><br></p>
<h4 id="훈련테스트-데이터에-대한-어텐션-마스킹">훈련/테스트 데이터에
대한 어텐션 마스킹</h4>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:121797,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010895953,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="2q81CbrDhZYi" data-outputId="b2c4277a-df94-4f06-8238-dedbf1066d79">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>train_X, train_y <span class="op">=</span> convert_examples_to_features(train_data[<span class="st">&#39;document&#39;</span>], train_data[<span class="st">&#39;label&#39;</span>], max_seq_len<span class="op">=</span>max_seq_len, tokenizer<span class="op">=</span>tokenizer)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 149995/149995 [01:57&lt;00:00, 1272.85it/s]
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:20843,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010916786,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="A0LLv-CchaTS" data-outputId="4b546f31-cb08-4b26-c35a-c1c993912d0c">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>test_X, test_y <span class="op">=</span> convert_examples_to_features(test_data[<span class="st">&#39;document&#39;</span>], test_data[<span class="st">&#39;label&#39;</span>], max_seq_len<span class="op">=</span>max_seq_len, tokenizer<span class="op">=</span>tokenizer)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 49997/49997 [00:19&lt;00:00, 2541.69it/s]
</code></pre>
</div>
</div>
<div class="cell markdown" id="11bdQKdcVo8D">
<p><br></p>
<ul>
<li>어텐션 마스킹 확인
<ul>
<li>최대 길이: 128</li>
</ul></li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010916786,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="X1NT5huFhbDy" data-outputId="49e5762c-8090-4e9e-dbce-426fa053bbc3">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>input_id <span class="op">=</span> train_X[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>attention_mask <span class="op">=</span> train_X[<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>token_type_id <span class="op">=</span> train_X[<span class="dv">2</span>][<span class="dv">0</span>]</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> train_y[<span class="dv">0</span>]</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;단어에 대한 정수 인코딩 :&#39;</span>,input_id)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;어텐션 마스크 :&#39;</span>,attention_mask)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;세그먼트 인코딩 :&#39;</span>,token_type_id)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;각 인코딩의 길이 :&#39;</span>, <span class="bu">len</span>(input_id))</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;정수 인코딩 복원 :&#39;</span>,tokenizer.decode(input_id))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;레이블 :&#39;</span>,label)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>단어에 대한 정수 인코딩 : [   101   9519   9074 119005    119    119   9708 119235   9715 119230
  16439  77884  48549   9284  22333  12692    102      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0      0      0
      0      0      0      0      0      0      0      0]
어텐션 마스크 : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
세그먼트 인코딩 : [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
각 인코딩의 길이 : 128
정수 인코딩 복원 : [CLS] 아 더빙.. 진짜 짜증나네요 목소리 [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]
레이블 : 0
</code></pre>
</div>
</div>
<div class="cell markdown" id="2mYvlNsWV3K4">
<p><br></p>
<h4 id="bert-모델-로드">BERT 모델 로드</h4>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:189,&quot;referenced_widgets&quot;:[&quot;68eacdc872fe458cb1087c757d350c67&quot;,&quot;6cf6b6b08be34ac59f3ca2cda5e314dd&quot;,&quot;3e43da0b591c4a0d8c3d694ecbf8e7fa&quot;,&quot;631cd5a2c79c482fafbd2d1e5c8ac81a&quot;,&quot;32ad4d9cfdce4f66bd1788012f9cd1bd&quot;,&quot;5757ad0d2ae84cabbb9eb52f142d366f&quot;,&quot;1c1626f3ec004c529debf7a57987dcff&quot;,&quot;67e34a2feeb249ef8fd742052f455bc0&quot;,&quot;292dc7d4b439418c810f72554f02b4ac&quot;,&quot;95da6537aef94e9881648c95f004f7ba&quot;,&quot;d6d9372d2e1e4c0b890f343ac8c241ff&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:31648,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010948425,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="dp6ZAIpYevaC" data-outputId="08cdd80c-64ed-4da4-a410-4c7bc62862fd">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TFBertModel.from_pretrained(<span class="st">&quot;bert-base-multilingual-cased&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb79"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;68eacdc872fe458cb1087c757d350c67&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBertModel: [&#39;cls.predictions.transform.LayerNorm.weight&#39;, &#39;cls.predictions.transform.dense.weight&#39;, &#39;cls.seq_relationship.bias&#39;, &#39;cls.predictions.transform.dense.bias&#39;, &#39;cls.predictions.transform.LayerNorm.bias&#39;, &#39;cls.seq_relationship.weight&#39;, &#39;cls.predictions.bias&#39;]
- This IS expected if you are initializing TFBertModel from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).
All the weights of TFBertModel were initialized from the PyTorch model.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
</code></pre>
</div>
</div>
<div class="cell markdown" id="VfgdAdjLW49Y">
<p><br></p>
<ul>
<li><strong>BERT모델의 입력층, 어텐션 마스킹층, 세그먼트 임베딩층
추가</strong></li>
</ul>
</div>
<div class="cell code" id="K-_jc-ft8tUp">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>max_seq_len <span class="op">=</span> <span class="dv">128</span></span></code></pre></div>
</div>
<div class="cell code" id="p_lt6RAclTjU">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>input_ids_layer <span class="op">=</span> tf.keras.layers.Input(shape<span class="op">=</span>(max_seq_len,), dtype<span class="op">=</span>tf.int32)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>attention_masks_layer <span class="op">=</span> tf.keras.layers.Input(shape<span class="op">=</span>(max_seq_len,), dtype<span class="op">=</span>tf.int32)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>token_type_ids_layer <span class="op">=</span> tf.keras.layers.Input(shape<span class="op">=</span>(max_seq_len,), dtype<span class="op">=</span>tf.int32)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>outputs <span class="op">=</span> model([input_ids_layer, attention_masks_layer, token_type_ids_layer])</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:16,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010956582,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="W68IEgzUlay_" data-outputId="0f9e416e-bccf-4a8b-f28c-cbce11f5dda9">
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outputs)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>TFBaseModelOutputWithPoolingAndCrossAttentions(last_hidden_state=&lt;KerasTensor: shape=(None, 128, 768) dtype=float32 (created by layer &#39;tf_bert_model&#39;)&gt;, pooler_output=&lt;KerasTensor: shape=(None, 768) dtype=float32 (created by layer &#39;tf_bert_model&#39;)&gt;, past_key_values=None, hidden_states=None, attentions=None, cross_attentions=None)
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:15,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010956582,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="FIZh3VRMlfE-" data-outputId="e34f791a-d3c2-45cf-cf2e-26b581f1d845">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outputs[<span class="dv">0</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>KerasTensor(type_spec=TensorSpec(shape=(None, 128, 768), dtype=tf.float32, name=None), name=&#39;tf_bert_model/bert/encoder/layer_._11/output/LayerNorm/batchnorm/add_1:0&#39;, description=&quot;created by layer &#39;tf_bert_model&#39;&quot;)
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:14,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010956582,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="WJdoCSSylgc5" data-outputId="74d0cf99-e70c-4f0b-ac52-9bddfaa5ec68">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outputs[<span class="dv">1</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>KerasTensor(type_spec=TensorSpec(shape=(None, 768), dtype=tf.float32, name=None), name=&#39;tf_bert_model/bert/pooler/dense/Tanh:0&#39;, description=&quot;created by layer &#39;tf_bert_model&#39;&quot;)
</code></pre>
</div>
</div>
<div class="cell markdown" id="21Xtk14tTECJ">

</div>
<div class="cell markdown" id="W0ZgufoPH5-b">
<p><br></p>
<h4 id="tpu-구동-및-모델-생성">TPU 구동 및 모델 생성</h4>
</div>
<div class="cell markdown" id="SSl89lFCdaJA">
<ul>
<li>모델 생성 클래스</li>
</ul>
</div>
<div class="cell code" id="xI5ugoovdWCq">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TFBertForSequenceClassification(tf.keras.Model):</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_name):</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(TFBertForSequenceClassification, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 입력 받은 BERT 모델 로드</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bert <span class="op">=</span> TFBertModel.from_pretrained(model_name, from_pt<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 이진 분류 출력층 생성</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.classifier <span class="op">=</span> tf.keras.layers.Dense(<span class="dv">1</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>                                                kernel_initializer<span class="op">=</span>tf.keras.initializers.TruncatedNormal(<span class="fl">0.02</span>),</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>                                                activation<span class="op">=</span><span class="st">&#39;sigmoid&#39;</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>                                                name<span class="op">=</span><span class="st">&#39;classifier&#39;</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> call(<span class="va">self</span>, inputs):</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>        input_ids, attention_mask, token_type_ids <span class="op">=</span> inputs</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> <span class="va">self</span>.bert(input_ids<span class="op">=</span>input_ids, attention_mask<span class="op">=</span>attention_mask, token_type_ids<span class="op">=</span>token_type_ids)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>        cls_token <span class="op">=</span> outputs[<span class="dv">1</span>]</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>        prediction <span class="op">=</span> <span class="va">self</span>.classifier(cls_token)</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> prediction</span></code></pre></div>
</div>
<div class="cell markdown" id="sdRboRDVdYUA">
<ul>
<li>TPU 환경 설정</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:12016,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010968585,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="9_6nzezphcoy" data-outputId="650489c7-3228-4255-a95d-f3d209ec10be">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>resolver <span class="op">=</span> tf.distribute.cluster_resolver.TPUClusterResolver(tpu<span class="op">=</span><span class="st">&#39;grpc://&#39;</span> <span class="op">+</span> os.environ[<span class="st">&#39;COLAB_TPU_ADDR&#39;</span>])</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>tf.config.experimental_connect_to_cluster(resolver)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>tf.tpu.experimental.initialize_tpu_system(resolver)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:TPU system grpc://10.45.185.178:8470 has already been initialized. Reinitializing the TPU can cause previously created variables on TPU to be lost.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="49">
<pre><code>&lt;tensorflow.python.tpu.topology.Topology at 0x78aea6fef100&gt;</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010968585,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="M-xMJuCjUxIn" data-outputId="ee915016-851f-482f-bff9-c33b998d40a0">
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>strategy <span class="op">=</span> tf.distribute.experimental.TPUStrategy(resolver)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>WARNING:absl:`tf.distribute.experimental.TPUStrategy` is deprecated, please use  the non experimental symbol `tf.distribute.TPUStrategy` instead.
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:189,&quot;referenced_widgets&quot;:[&quot;bc5fe52f444942b6a941a9f337b647b2&quot;,&quot;4a4091962b904ee3bbef0715a9de752e&quot;,&quot;a1af041e079a4f1fbde3579910d44da4&quot;,&quot;c0ba75a47beb4f4ea386e2d2bb7a9cbf&quot;,&quot;8e26e89b02464e5eb407c68e6f64a342&quot;,&quot;04cf4f5a6a5c4e62b9d3a1e17558a4ab&quot;,&quot;4c3692cc5f3c4db38bae1db6f1ba4118&quot;,&quot;c10ceac5525c420484ff82c505cc9cf2&quot;,&quot;4cbc8de4dc004f5fb469eecd39cdf22c&quot;,&quot;2b8d147a2e0047f79d481728092ba96e&quot;,&quot;ee6e17b37eca4c76b96c1b1f8b3d3269&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:25724,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708010994843,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="wz2VsrZnUeJf" data-outputId="eedfcf15-3424-45f1-fca4-9bd4605ca5c9">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> strategy.scope():</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> TFBertForSequenceClassification(<span class="st">&quot;bert-base-multilingual-cased&quot;</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  optimizer <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">5e-5</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> tf.keras.losses.BinaryCrossentropy()</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  model.<span class="bu">compile</span>(optimizer<span class="op">=</span>optimizer, loss<span class="op">=</span>loss, metrics <span class="op">=</span> [<span class="st">&#39;accuracy&#39;</span>])</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb96"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;bc5fe52f444942b6a941a9f337b647b2&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBertModel: [&#39;cls.predictions.transform.LayerNorm.weight&#39;, &#39;cls.predictions.transform.dense.weight&#39;, &#39;cls.seq_relationship.bias&#39;, &#39;cls.predictions.transform.dense.bias&#39;, &#39;cls.predictions.transform.LayerNorm.bias&#39;, &#39;cls.predictions.decoder.weight&#39;, &#39;cls.seq_relationship.weight&#39;, &#39;cls.predictions.bias&#39;]
- This IS expected if you are initializing TFBertModel from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).
All the weights of TFBertModel were initialized from the PyTorch model.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
</code></pre>
</div>
</div>
<div class="cell markdown" id="EU1A6RV-clMQ">
<p><br></p>
<h4 id="모델-적합">모델 적합</h4>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:615889,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011610723,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="DQEGFSnbU8U1" data-outputId="abf81c3e-7cd2-4b3f-a35c-a3791dd7c775">
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>model.fit(train_X, train_y, epochs<span class="op">=</span><span class="dv">2</span>, batch_size<span class="op">=</span><span class="dv">64</span>, validation_split<span class="op">=</span><span class="fl">0.2</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/2
1875/1875 [==============================] - 344s 128ms/step - loss: 0.4077 - accuracy: 0.8076 - val_loss: 0.3367 - val_accuracy: 0.8551
Epoch 2/2
1875/1875 [==============================] - 229s 122ms/step - loss: 0.3172 - accuracy: 0.8618 - val_loss: 0.3214 - val_accuracy: 0.8582
</code></pre>
</div>
<div class="output execute_result" data-execution_count="52">
<pre><code>&lt;keras.callbacks.History at 0x78aea16746a0&gt;</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:23978,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011635176,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="zRMrp8dyVqQA" data-outputId="107be965-3406-4ed2-8564-63f62623317d">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.evaluate(test_X, test_y, batch_size<span class="op">=</span><span class="dv">1024</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;test loss, test acc: &quot;</span>, results)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>49/49 [==============================] - 22s 330ms/step - loss: 0.3258 - accuracy: 0.8581
test loss, test acc:  [0.3257826864719391, 0.8581115007400513]
</code></pre>
</div>
</div>
<div class="cell markdown" id="S8p1fwkqcoPz">
<p><br></p>
<h4 id="모델-평가">모델 평가</h4>
</div>
<div class="cell code" id="Ygvuug5qeV2b">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sentiment_predict(new_sentence):</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  input_id <span class="op">=</span> tokenizer.encode(new_sentence, max_length<span class="op">=</span>max_seq_len, pad_to_max_length<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  padding_count <span class="op">=</span> input_id.count(tokenizer.pad_token_id)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  attention_mask <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (max_seq_len <span class="op">-</span> padding_count) <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> padding_count</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  token_type_id <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> max_seq_len</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  input_ids <span class="op">=</span> np.array([input_id])</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  attention_masks <span class="op">=</span> np.array([attention_mask])</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  token_type_ids <span class="op">=</span> np.array([token_type_id])</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  encoded_input <span class="op">=</span> [input_ids, attention_masks, token_type_ids]</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>  score <span class="op">=</span> model.predict(encoded_input)[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(score)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(score <span class="op">&gt;</span> <span class="fl">0.5</span>):</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{:.2f}</span><span class="st">% 확률로 긍정 리뷰입니다.</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(score <span class="op">*</span> <span class="dv">100</span>))</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{:.2f}</span><span class="st">% 확률로 부정 리뷰입니다.</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>((<span class="dv">1</span> <span class="op">-</span> score) <span class="op">*</span> <span class="dv">100</span>))</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:9473,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011644646,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="TMFPAdECfFer" data-outputId="b8e1e12c-c13f-4b1b-b36d-7944189473b2">
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&quot;보던거라 계속보고있는데 전개도 느리고 주인공인 은희는 한두컷 나오면서 소극적인모습에 &quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 10s 10s/step
0.117415756
88.26% 확률로 부정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:687,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011645324,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Fn4utaVUfwSL" data-outputId="d91ab3a0-9037-48d5-fd45-ea213bac8fe1">
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&quot;스토리는 확실히 실망이였지만 배우들 연기력이 대박이였다 특히 이제훈 연기 정말 ... 이 배우들로 이렇게밖에 만들지 못한 영화는 아쉽지만 배우들 연기력과 사운드는 정말 빛났던 영화. 기대하고 극장에서 보면 많이 실망했겠지만 평점보고 기대없이 집에서 편하게 보면 괜찮아요. 이제훈님 연기력은 최고인 것 같습니다&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 742ms/step
0.95116496
95.12% 확률로 긍정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:906,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011646228,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="tPA0waJugXmp" data-outputId="9ffbd3e3-8323-4bf1-af3e-b6e2b9cd7120">
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&quot;별 똥같은 영화를 다 보네. 개별로입니다.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 630ms/step
0.13549471
86.45% 확률로 부정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:702,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011646927,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="K-TZu5SOgZ7J" data-outputId="9e88ff07-a60b-4b84-c4b3-f8e7503757c3">
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&quot;이 영화 존잼입니다 대박.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 661ms/step
0.96983546
96.98% 확률로 긍정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1145,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011648070,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="bWA-tj0MgloI" data-outputId="abf02026-1c40-4e8b-fafe-2493cfe1d173">
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&#39;이 영화 개꿀잼 ㅋㅋㅋ&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 762ms/step
0.56645006
56.65% 확률로 긍정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:535,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011648603,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="ikVmPhsTgnLx" data-outputId="e5cc15d2-8de3-48f2-80c8-28ff76bb9809">
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&#39;이딴게 영화냐 ㅉㅉ&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 592ms/step
0.035006046
96.50% 확률로 부정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:625,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011649226,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="y98TYwe6goOS" data-outputId="6277dea1-6b59-4074-d565-6ca2f92c84b5">
<div class="sourceCode" id="cb116"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&#39;감독 뭐하는 놈이냐?&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 601ms/step
0.064368755
93.56% 확률로 부정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:745,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708011649969,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="LEFMc5WMgp-C" data-outputId="35300e15-a64e-4365-8858-fa05af77e863">
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>sentiment_predict(<span class="st">&#39;와 개쩐다 정말 세계관 최강자들의 영화다&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1/1 [==============================] - 1s 588ms/step
0.79921585
79.92% 확률로 긍정 리뷰입니다.

</code></pre>
</div>
</div>
<div class="cell markdown" id="0oRcCjjoYWCg">
<p><br></p>
<h2 id="kobert를-이용한-네이버-영화-리뷰-분류">KoBERT를 이용한 네이버
영화 리뷰 분류</h2>
</div>
<div class="cell code" data-execution_count="113"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708019548828,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="wDJX-FTd97_P">
<div class="sourceCode" id="cb120"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span></code></pre></div>
</div>
<div class="cell markdown" id="zFQmvOQrihRX">
<p><br></p>
<h4 id="데이터-로드">데이터 로드</h4>
</div>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1189,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014963771,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="ouYwJL5D-IJn" data-outputId="9e84795c-4950-46e1-9b0c-e1c2ddc74ecf">
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/e9t/nsmc/master/ratings_train.txt&quot;</span>, filename<span class="op">=</span><span class="st">&quot;ratings_train.txt&quot;</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/e9t/nsmc/master/ratings_test.txt&quot;</span>, filename<span class="op">=</span><span class="st">&quot;ratings_test.txt&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">
<pre><code>(&#39;ratings_test.txt&#39;, &lt;http.client.HTTPMessage at 0x78ae80da3af0&gt;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-executionInfo="{&quot;elapsed&quot;:1053,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014965209,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="ZgM5ejYJ-JVy">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> pd.read_table(<span class="st">&#39;ratings_train.txt&#39;</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_table(<span class="st">&#39;ratings_test.txt&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="66"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014965209,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="8eKKwxMQ-KPo" data-outputId="c96e07be-ad87-44e4-efb2-86e996e4efbd">
<div class="sourceCode" id="cb124"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;훈련용 리뷰 개수 :&#39;</span>,<span class="bu">len</span>(train_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>훈련용 리뷰 개수 : 150000
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="67"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014965209,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="jWRABrUA-MMy" data-outputId="26797271-8c9b-4f82-895c-eb44bb14cdb6">
<div class="sourceCode" id="cb126"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>train_data[:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="67">

  <div id="df-124f267f-c848-4787-85e2-875c4b6d9ca4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>document</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9976970</td>
      <td>아 더빙.. 진짜 짜증나네요 목소리</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3819312</td>
      <td>흠...포스터보고 초딩영화줄....오버연기조차 가볍지 않구나</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10265843</td>
      <td>너무재밓었다그래서보는것을추천한다</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9045019</td>
      <td>교도소 이야기구먼 ..솔직히 재미는 없다..평점 조정</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6483659</td>
      <td>사이몬페그의 익살스런 연기가 돋보였던 영화!스파이더맨에서 늙어보이기만 했던 커스틴 ...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-124f267f-c848-4787-85e2-875c4b6d9ca4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-124f267f-c848-4787-85e2-875c4b6d9ca4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-124f267f-c848-4787-85e2-875c4b6d9ca4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fb5ae76f-7919-40e5-9c89-5550eae3dec4">
  <button class="colab-df-quickchart" onclick="quickchart('df-fb5ae76f-7919-40e5-9c89-5550eae3dec4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fb5ae76f-7919-40e5-9c89-5550eae3dec4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="68"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014966414,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="BNErKm0M-NLC" data-outputId="ec1ed832-9450-4dec-8d7f-d427ad1a67c9">
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;테스트용 리뷰 개수 :&#39;</span>,<span class="bu">len</span>(test_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>테스트용 리뷰 개수 : 50000
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:683,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014967095,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="g_Hh3jID-OEp" data-outputId="c010eee0-256b-422e-8d99-ad7c83c9464f">
<div class="sourceCode" id="cb129"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>test_data[:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="69">

  <div id="df-f5de6194-156f-408e-b067-b76d5d0623d6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>document</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6270596</td>
      <td>굳 ㅋ</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9274899</td>
      <td>GDNTOPCLASSINTHECLUB</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8544678</td>
      <td>뭐야 이 평점들은.... 나쁘진 않지만 10점 짜리는 더더욱 아니잖아</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6825595</td>
      <td>지루하지는 않은데 완전 막장임... 돈주고 보기에는....</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6723715</td>
      <td>3D만 아니었어도 별 다섯 개 줬을텐데.. 왜 3D로 나와서 제 심기를 불편하게 하죠??</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f5de6194-156f-408e-b067-b76d5d0623d6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f5de6194-156f-408e-b067-b76d5d0623d6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f5de6194-156f-408e-b067-b76d5d0623d6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-616c8b78-3cfc-4e58-9d82-24490dac51fd">
  <button class="colab-df-quickchart" onclick="quickchart('df-616c8b78-3cfc-4e58-9d82-24490dac51fd')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-616c8b78-3cfc-4e58-9d82-24490dac51fd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="ovcVMXQrjFh4">
<p><br></p>
<ul>
<li>중복값 제거</li>
</ul>
</div>
<div class="cell code" data-execution_count="70"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014968219,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="oKau4ZB4-PHR" data-outputId="72f677b5-d490-44ed-85a3-f059ffbed7e0">
<div class="sourceCode" id="cb130"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>train_data[<span class="st">&#39;document&#39;</span>].nunique(), train_data[<span class="st">&#39;label&#39;</span>].nunique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="70">
<pre><code>(146182, 2)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="71"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014968219,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="gwjLU3sK-P8S">
<div class="sourceCode" id="cb132"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>train_data.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;document&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014968219,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Oi5hc8XK-Q6J" data-outputId="b3af343f-6ea6-4bd0-e583-917cd4fc94e6">
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;총 샘플의 수 :&#39;</span>,<span class="bu">len</span>(train_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>총 샘플의 수 : 146183
</code></pre>
</div>
</div>
<div class="cell markdown" id="6UJEokDPi92b">
<p><br></p>
<ul>
<li>클래스 분포 확인</li>
</ul>
</div>
<div class="cell code" data-execution_count="73"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:425}"
data-executionInfo="{&quot;elapsed&quot;:588,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014969096,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="QgRVFLKB-SBq" data-outputId="b57af8df-79f7-48cf-f270-2f699ce8e504">
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>train_data[<span class="st">&#39;label&#39;</span>].value_counts().plot(kind <span class="op">=</span> <span class="st">&#39;bar&#39;</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_956851493c384197b174daa40fd81e09/6b2c48b70516d7c51fe780babb03e51c1cacf4f6.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014969096,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="E01wE0Un-S2K" data-outputId="9f55c4bf-7144-4850-f2a5-cd1fbdaff4af">
<div class="sourceCode" id="cb136"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.groupby(<span class="st">&#39;label&#39;</span>).size().reset_index(name <span class="op">=</span> <span class="st">&#39;count&#39;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>   label  count
0      0  73342
1      1  72841
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="75"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:434,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014970871,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="ovzYezac-Ubx" data-outputId="bfed4f4c-f1a9-4dd4-a3c4-e8c0720cc82c">
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.isnull().values.<span class="bu">any</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>True
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="76"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014970872,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="2cCIiEml-VaZ" data-outputId="d26c819f-9153-48db-d26b-2f804c7326c7">
<div class="sourceCode" id="cb140"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>id          0
document    1
label       0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="77"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014971835,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="8nVohuxd-Wjp" data-outputId="97e120b6-5d89-4447-9f89-bab6b59a1a9f">
<div class="sourceCode" id="cb142"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>train_data.loc[train_data.document.isnull()]</span></code></pre></div>
<div class="output execute_result" data-execution_count="77">

  <div id="df-b29d1618-8a1f-42c7-b407-6b2730cb76a0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>document</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25857</th>
      <td>2172111</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b29d1618-8a1f-42c7-b407-6b2730cb76a0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b29d1618-8a1f-42c7-b407-6b2730cb76a0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b29d1618-8a1f-42c7-b407-6b2730cb76a0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="e7GSSpqWjB7Q">
<ul>
<li>결측값 제거</li>
</ul>
</div>
<div class="cell code" data-execution_count="78"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:326,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014973377,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="mTOvlHGY-XeJ" data-outputId="e8c95778-552a-49ba-a428-ed751dd01403">
<div class="sourceCode" id="cb143"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.dropna(how <span class="op">=</span> <span class="st">&#39;any&#39;</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.isnull().values.<span class="bu">any</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>False
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="79"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014974950,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Rd7hawaI-YSJ" data-outputId="3b970d98-edba-401a-94d7-487e72b38ad3">
<div class="sourceCode" id="cb145"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(train_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>146182
</code></pre>
</div>
</div>
<div class="cell markdown" id="GHEpuOOdK8FO">
<p><br></p>
<h4 id="어텐션-마스킹--세그먼트-임베딩">어텐션 마스킹 &amp; 세그먼트
임베딩</h4>
<h4 id="kobert-토크나이저를-이용한-정수-인코딩">KoBERT 토크나이저를
이용한 정수 인코딩</h4>
</div>
<div class="cell code" id="yZU7HFCU-lt1">
<div class="sourceCode" id="cb147"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install transformers</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="114"
data-executionInfo="{&quot;elapsed&quot;:273,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708019554416,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="gvDDeDrM-n0u">
<div class="sourceCode" id="cb148"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> transformers</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> BertTokenizerFast</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="83"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:177,&quot;referenced_widgets&quot;:[&quot;d79e50c40ab6432b82db40ff3e9e0782&quot;,&quot;4ea95d7e26ba4355bbd9b5a2c3a66ed5&quot;,&quot;13ce56e65ee94ddeaf680ad127f49fbc&quot;,&quot;ffbc43aea63042e2a12a42170eb4d750&quot;,&quot;3ddfc6e4bad44021b07522479ec3c48a&quot;,&quot;7ddc6d0976814fa4805531513d0cdd39&quot;,&quot;c061166fc6f646cdbb95db00a94c08f3&quot;,&quot;e453060909704b51a198084549d415a9&quot;,&quot;f311100d6dc241f8a7557cf49e3cd1ad&quot;,&quot;448590cc35be42b7816171397ac65088&quot;,&quot;4fbf86717f63483ba7b42573cec799a1&quot;,&quot;baf825d609424a15a46afc8e86245750&quot;,&quot;15d058aaf6604cfb9600b06ad5cc9f11&quot;,&quot;440e9cb5372b4c8c99697958b32ee689&quot;,&quot;8d6a0fe6184a433ba724bb86b3ac25b9&quot;,&quot;d5de69dc98b341f08fc0eba4c9cd76f5&quot;,&quot;fd2f7af95c604e09a56788b3ea65595c&quot;,&quot;36f09cee910547678618fb9866102541&quot;,&quot;a299166a2b454387ab75279dd0d8f4ff&quot;,&quot;dc78b6385116469fa568679012f7370d&quot;,&quot;df02549d638d48a6bc68236a6d21cfbc&quot;,&quot;5c316888e5e7415db8927e127c2587a2&quot;,&quot;c5376fd7d90f4068a38cc6a705871884&quot;,&quot;ecaf5fd38dac4f368155e0c42f1d359a&quot;,&quot;c529bb40e51c464caef28fe9b6a71417&quot;,&quot;c53ffe0b5048443ebba8117065378783&quot;,&quot;cb3a186dd8e046dcb8df185c8eaa2630&quot;,&quot;45efcf1b904548d3846db75e45265191&quot;,&quot;e857ef6ef2f04f25b19c2b5c0e675cea&quot;,&quot;7084b28176dd458ba26a0260f7ceaaaf&quot;,&quot;abfd41abca434d2bbbda9758a9c3a3b1&quot;,&quot;303f804b2a2843b7b3ed59b26fd6406d&quot;,&quot;a0d90ef265ee4e4eb6dac19bd432148b&quot;,&quot;b6206d82268440c79f5c1717c4ddb5ba&quot;,&quot;8fe65b0d141a484fb1ae1ffec7ccdd6b&quot;,&quot;6e16993047034d8995e88e4b1a6cd569&quot;,&quot;ffa9bc647dd54b22bcd67353a9d12c84&quot;,&quot;1539e99d311c42cc88d9182d93dbeffa&quot;,&quot;73835a8a8e8246a982c518f37751ad73&quot;,&quot;5aae3064b5984ba4b58d80445f9e1603&quot;,&quot;b37abf49378843989c9fdc07493ae850&quot;,&quot;c1bcb65124ed4ed9b8b10d7684c64098&quot;,&quot;85ab9b0eb0354030b135b3688f920120&quot;,&quot;bc0658ad037649e4be34742bf3167c96&quot;,&quot;54faf5e66536479a9490ad7452f38fbb&quot;,&quot;78d675db928f4cbeacf741440cd3e007&quot;,&quot;b736d609cb6744f4b3b65bbb8151d7bc&quot;,&quot;8b21b85559fd4ac88a9b9f34b8bc250f&quot;,&quot;e77d538243f74e2ca9a0640d9dc57d47&quot;,&quot;b6b14e7be228434aba4b311b460fe2a0&quot;,&quot;c29cc2b870e34b49bfc0d78fa49a564f&quot;,&quot;028126fe99fc43f19973dc5610373ca8&quot;,&quot;59cb502d92434758a0d1ca98302a9d18&quot;,&quot;e7ab795440fc471e84670cd9479cf950&quot;,&quot;03edec36183f4603b2b8ad6878fc610e&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:1344,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014986331,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="41FrBdyM-ZIB" data-outputId="843674d3-1a92-4be3-e456-634a4ad00309">
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> BertTokenizerFast.from_pretrained(<span class="st">&quot;klue/bert-base&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb150"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d79e50c40ab6432b82db40ff3e9e0782&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb151"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;baf825d609424a15a46afc8e86245750&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb152"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;c5376fd7d90f4068a38cc6a705871884&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb153"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;b6206d82268440c79f5c1717c4ddb5ba&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">
<div class="sourceCode" id="cb154"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;54faf5e66536479a9490ad7452f38fbb&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell markdown" id="CJ0M5pjjjQpp">
<p><br></p>
<ul>
<li><p><strong>토크나이저의 <code>padding</code>을 <code>TRUE</code>로
설정 <span class="math inline">→</span> 문장 최대길이에 맞는 패딩 <span
class="math inline">→</span> 어텐션 마스킹</strong></p></li>
<li><p><code>type_ids</code>는 지금 풀고자 하는 문제에서 문장의 종류의
개수를 의미하는데,</p>
<p>일반적으로 두 개 이상의 문장을 가지고 푸는 문제일 경우에는 [0, 0, 0,
0, 1, 1, 1, 1] 이런 식의 값이 들어가지만 네이버 영화 리뷰는 문장 1개를
보고 푸는 문제라서 [0, 0, 0, 0, 0, 0, 0, 0]이 들어감</p></li>
</ul>
</div>
<div class="cell code" data-execution_count="84"
data-executionInfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014991298,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="cwQQhnKJ_fvm">
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> test_data.dropna(how <span class="op">=</span> <span class="st">&#39;any&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="85"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014992899,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="cn0zlt2n_jbW" data-outputId="1a472f34-6f13-411b-b95a-0f5b506aa580">
<div class="sourceCode" id="cb156"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(test_data))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>49997
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="86"
data-executionInfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708014994258,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="s2Oohiy--1uC">
<div class="sourceCode" id="cb158"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>X_train_list <span class="op">=</span> train_data[<span class="st">&#39;document&#39;</span>].tolist()</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>X_test_list <span class="op">=</span> test_data[<span class="st">&#39;document&#39;</span>].tolist()</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train_data[<span class="st">&#39;label&#39;</span>].tolist()</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test_data[<span class="st">&#39;label&#39;</span>].tolist()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="87"
data-executionInfo="{&quot;elapsed&quot;:52221,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015047289,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="d7o55GB2-lJX">
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> tokenizer(X_train_list, truncation<span class="op">=</span><span class="va">True</span>, padding<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> tokenizer(X_test_list, truncation<span class="op">=</span><span class="va">True</span>, padding<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="88"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015047290,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="VsGOxExmA2NC" data-outputId="12aea8f0-d91c-4cd8-f28c-17597aa826e6">
<div class="sourceCode" id="cb160"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train[<span class="dv">0</span>].tokens)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;[CLS]&#39;, &#39;아&#39;, &#39;더&#39;, &#39;##빙&#39;, &#39;.&#39;, &#39;.&#39;, &#39;진짜&#39;, &#39;짜증&#39;, &#39;##나&#39;, &#39;##네&#39;, &#39;##요&#39;, &#39;목소리&#39;, &#39;[SEP]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;, &#39;[PAD]&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="89"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015047290,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="y9yzE-xx_zPy" data-outputId="db478f9f-af57-4c77-e6ba-1260d2121c77">
<div class="sourceCode" id="cb162"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train[<span class="dv">0</span>].ids)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[2, 1376, 831, 2604, 18, 18, 4229, 9801, 2075, 2203, 2182, 4243, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="90"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015047290,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="5HPQqAKFAJPG" data-outputId="93847962-f36f-47b3-f387-51aeda2d1853">
<div class="sourceCode" id="cb164"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train[<span class="dv">0</span>].type_ids)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="91"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015047290,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="lGoaRd3VA7aC" data-outputId="fdb2d994-105f-45bd-9604-af87c74a7396">
<div class="sourceCode" id="cb166"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train[<span class="dv">0</span>].attention_mask)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</code></pre>
</div>
</div>
<section id="데이터셋-생성" class="cell markdown" id="BnJn7gITLDMS">
<h4>데이터셋 생성</h4>
</section>
<div class="cell code" data-execution_count="115"
data-executionInfo="{&quot;elapsed&quot;:329,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708019557850,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="PFhDIg81kHCT">
<div class="sourceCode" id="cb168"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="93"
data-executionInfo="{&quot;elapsed&quot;:194031,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015241319,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="R66oaOq7SsrJ">
<div class="sourceCode" id="cb169"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> tf.data.Dataset.from_tensor_slices((</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">dict</span>(X_train),</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    y_train</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>val_dataset <span class="op">=</span> tf.data.Dataset.from_tensor_slices((</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">dict</span>(X_test),</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>    y_test</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
<div class="cell markdown" id="KUm9zJQMkO80">
<p><br></p>
<h4 id="모델-생성--컴파일">모델 생성 &amp; 컴파일</h4>
</div>
<div class="cell code" data-execution_count="116"
data-executionInfo="{&quot;elapsed&quot;:296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708019561410,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="hQ-iNGifRt51">
<div class="sourceCode" id="cb170"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> TFBertForSequenceClassification</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="95"
data-executionInfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015241319,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="jYRjOgCW1T3K">
<div class="sourceCode" id="cb171"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">5e-5</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="98"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:161,&quot;referenced_widgets&quot;:[&quot;d4ff437eef9e4a0e9148ff98f7eb9754&quot;,&quot;b4189851ed89461493ef891534d67e8c&quot;,&quot;d2b0eb19526e4991ac5a2d3ccb689663&quot;,&quot;08dc886c1e5146d099a74823e0ba3292&quot;,&quot;0be6ff6fdc0245fdb6ed22c963dff7c7&quot;,&quot;a8645f459f724dd584464b47cf8fdc6c&quot;,&quot;fad934dddcf14b1e86de4d848964fdc6&quot;,&quot;99dc6b22cb7046468382f2d083adf1d9&quot;,&quot;caf5251d67e04481ba5213a5a2595fbc&quot;,&quot;cd4b58a396714f6496643f79b6889abf&quot;,&quot;b14a8eebfdce4aaf9eeadd3f8f12b310&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:13977,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015275624,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="sMosF9zffeBW" data-outputId="f0d42737-05f3-4606-9310-742eca3f29a0">
<div class="sourceCode" id="cb172"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TFBertForSequenceClassification.from_pretrained(<span class="st">&quot;klue/bert-base&quot;</span>, num_labels<span class="op">=</span><span class="dv">2</span>, from_pt<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span>optimizer, loss<span class="op">=</span>model.hf_compute_loss, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb173"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;d4ff437eef9e4a0e9148ff98f7eb9754&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBertForSequenceClassification: [&#39;bert.embeddings.position_ids&#39;]
- This IS expected if you are initializing TFBertForSequenceClassification from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertForSequenceClassification from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).
Some weights or buffers of the TF 2.0 model TFBertForSequenceClassification were not initialized from the PyTorch model and are newly initialized: [&#39;classifier.weight&#39;, &#39;classifier.bias&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</code></pre>
</div>
</div>
<div class="cell markdown" id="W4M1Sv_QkTXa">
<p><br></p>
<h4 id="모델-적합">모델 적합</h4>
<ul>
<li>콜백 옵션 조기종료 설정</li>
</ul>
</div>
<div class="cell code" data-execution_count="96"
data-executionInfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708015241319,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="0VR8EjSwR_f2">
<div class="sourceCode" id="cb175"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>callback_earlystop <span class="op">=</span> EarlyStopping(</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">&quot;val_accuracy&quot;</span>,</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>    min_delta<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>    patience<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="109"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:391}"
data-executionInfo="{&quot;elapsed&quot;:4174,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1708019311804,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="zXKdG7-WksWC" data-outputId="65adce17-a44b-43f1-ed03-a40aaebba901">
<div class="sourceCode" id="cb176"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>model.fit(</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>    train_dataset.shuffle(<span class="dv">10000</span>).batch(<span class="dv">32</span>), epochs<span class="op">=</span><span class="dv">5</span>, batch_size<span class="op">=</span><span class="dv">64</span>,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>    validation_data <span class="op">=</span> val_dataset.shuffle(<span class="dv">10000</span>).batch(<span class="dv">64</span>),</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    callbacks <span class="op">=</span> [callback_earlystop]</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/5
</code></pre>
</div>
<div class="output error" data-ename="KeyboardInterrupt" data-evalue="">
<pre><code>---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
&lt;ipython-input-109-fcfa2d3db2bb&gt; in &lt;cell line: 1&gt;()
----&gt; 1 model.fit(
      2     train_dataset.shuffle(10000).batch(32), epochs=5, batch_size=64,
      3     validation_data = val_dataset.shuffle(10000).batch(64),
      4     callbacks = [callback_earlystop]
      5 )

/usr/local/lib/python3.10/dist-packages/keras/utils/traceback_utils.py in error_handler(*args, **kwargs)
     63         filtered_tb = None
     64         try:
---&gt; 65             return fn(*args, **kwargs)
     66         except Exception as e:
     67             filtered_tb = _process_traceback_frames(e.__traceback__)

/usr/local/lib/python3.10/dist-packages/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)
   1689                             logs = tmp_logs
   1690                             end_step = step + data_handler.step_increment
-&gt; 1691                             callbacks.on_train_batch_end(end_step, logs)
   1692                             if self.stop_training:
   1693                                 break

/usr/local/lib/python3.10/dist-packages/keras/callbacks.py in on_train_batch_end(self, batch, logs)
    473         &quot;&quot;&quot;
    474         if self._should_call_train_batch_hooks:
--&gt; 475             self._call_batch_hook(ModeKeys.TRAIN, &quot;end&quot;, batch, logs=logs)
    476 
    477     def on_test_batch_begin(self, batch, logs=None):

/usr/local/lib/python3.10/dist-packages/keras/callbacks.py in _call_batch_hook(self, mode, hook, batch, logs)
    320             self._call_batch_begin_hook(mode, batch, logs)
    321         elif hook == &quot;end&quot;:
--&gt; 322             self._call_batch_end_hook(mode, batch, logs)
    323         else:
    324             raise ValueError(

/usr/local/lib/python3.10/dist-packages/keras/callbacks.py in _call_batch_end_hook(self, mode, batch, logs)
    343             self._batch_times.append(batch_time)
    344 
--&gt; 345         self._call_batch_hook_helper(hook_name, batch, logs)
    346 
    347         if len(self._batch_times) &gt;= self._num_batches_for_timing_check:

/usr/local/lib/python3.10/dist-packages/keras/callbacks.py in _call_batch_hook_helper(self, hook_name, batch, logs)
    391         for callback in self.callbacks:
    392             hook = getattr(callback, hook_name)
--&gt; 393             hook(batch, logs)
    394 
    395         if self._check_timing:

/usr/local/lib/python3.10/dist-packages/keras/callbacks.py in on_train_batch_end(self, batch, logs)
   1091 
   1092     def on_train_batch_end(self, batch, logs=None):
-&gt; 1093         self._batch_update_progbar(batch, logs)
   1094 
   1095     def on_test_batch_end(self, batch, logs=None):

/usr/local/lib/python3.10/dist-packages/keras/callbacks.py in _batch_update_progbar(self, batch, logs)
   1167         if self.verbose == 1:
   1168             # Only block async when verbose = 1.
-&gt; 1169             logs = tf_utils.sync_to_numpy_or_python_type(logs)
   1170             self.progbar.update(self.seen, list(logs.items()), finalize=False)
   1171 

/usr/local/lib/python3.10/dist-packages/keras/utils/tf_utils.py in sync_to_numpy_or_python_type(tensors)
    678         return t.item() if np.ndim(t) == 0 else t
    679 
--&gt; 680     return tf.nest.map_structure(_to_single_numpy_or_python_type, tensors)
    681 
    682 

/usr/local/lib/python3.10/dist-packages/tensorflow/python/util/nest.py in map_structure(func, *structure, **kwargs)
    915 
    916   return pack_sequence_as(
--&gt; 917       structure[0], [func(*x) for x in entries],
    918       expand_composites=expand_composites)
    919 

/usr/local/lib/python3.10/dist-packages/tensorflow/python/util/nest.py in &lt;listcomp&gt;(.0)
    915 
    916   return pack_sequence_as(
--&gt; 917       structure[0], [func(*x) for x in entries],
    918       expand_composites=expand_composites)
    919 

/usr/local/lib/python3.10/dist-packages/keras/utils/tf_utils.py in _to_single_numpy_or_python_type(t)
    671         # Don&#39;t turn ragged or sparse tensors to NumPy.
    672         if isinstance(t, tf.Tensor):
--&gt; 673             t = t.numpy()
    674         # Strings, ragged and sparse tensors don&#39;t have .item(). Return them
    675         # as-is.

/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/ops.py in numpy(self)
   1158     &quot;&quot;&quot;
   1159     # TODO(slebedev): Consider avoiding a copy for non-CPU or remote tensors.
-&gt; 1160     maybe_arr = self._numpy()  # pylint: disable=protected-access
   1161     return maybe_arr.copy() if isinstance(maybe_arr, np.ndarray) else maybe_arr
   1162 

/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/ops.py in _numpy(self)
   1124   def _numpy(self):
   1125     try:
-&gt; 1126       return self._numpy_internal()
   1127     except core._NotOkStatusException as e:  # pylint: disable=protected-access
   1128       raise core._status_to_exception(e) from None  # pylint: disable=protected-access

KeyboardInterrupt: 
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="101"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1047509,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708019052685,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="mhhwtAVJ05Yk" data-outputId="83be7428-a182-438e-af84-100ef9779c45">
<div class="sourceCode" id="cb179"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>model.evaluate(val_dataset.batch(<span class="dv">1024</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>49/49 [==============================] - 1047s 21s/step - loss: 0.3141 - accuracy: 0.8695
</code></pre>
</div>
<div class="output execute_result" data-execution_count="101">
<pre><code>[0.3141085207462311, 0.8694721460342407]</code></pre>
</div>
</div>
<div class="cell markdown" id="s3JQ3e7aKJi2">
<p><br></p>
<h4 id="모델-저장">모델 저장</h4>
</div>
<div class="cell code" data-execution_count="102"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10854,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708019063528,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="UFTNFRTWEe7T" data-outputId="5fe4becf-15eb-4073-fab3-efd4af3f8662">
<div class="sourceCode" id="cb182"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>model.save_pretrained(<span class="st">&#39;nsmc_model/bert-base&#39;</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>tokenizer.save_pretrained(<span class="st">&#39;nsmc_model/bert-base&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="102">
<pre><code>(&#39;nsmc_model/bert-base/tokenizer_config.json&#39;,
 &#39;nsmc_model/bert-base/special_tokens_map.json&#39;,
 &#39;nsmc_model/bert-base/vocab.txt&#39;,
 &#39;nsmc_model/bert-base/added_tokens.json&#39;,
 &#39;nsmc_model/bert-base/tokenizer.json&#39;)</code></pre>
</div>
</div>
<div class="cell markdown" id="80wcJjoUKK8M">
<p><br></p>
<h4 id="모델-로드-및-테스트">모델 로드 및 테스트</h4>
</div>
<div class="cell code" id="bPjVgd1rkcVD">
<div class="sourceCode" id="cb184"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> TextClassificationPipeline</span></code></pre></div>
</div>
<div class="cell markdown" id="8tcBXub85-tQ">
<ul>
<li>모델 로드</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="oeD8GOQw54n-" data-outputId="7a1e3978-7564-4229-cbb7-6a29db38fab5">
<div class="sourceCode" id="cb185"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>loaded_tokenizer <span class="op">=</span> BertTokenizerFast.from_pretrained(<span class="st">&#39;nsmc_model/bert-base&#39;</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>loaded_model <span class="op">=</span> TFBertForSequenceClassification.from_pretrained(<span class="st">&#39;nsmc_model/bert-base&#39;</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>text_classifier <span class="op">=</span> TextClassificationPipeline(</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    tokenizer<span class="op">=</span>loaded_tokenizer,</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>loaded_model,</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    framework<span class="op">=</span><span class="st">&#39;tf&#39;</span>,</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    return_all_scores<span class="op">=</span><span class="va">True</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Some layers from the model checkpoint at nsmc_model/bert-base were not used when initializing TFBertForSequenceClassification: [&#39;dropout_37&#39;]
- This IS expected if you are initializing TFBertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFBertForSequenceClassification were initialized from the model checkpoint at nsmc_model/bert-base.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertForSequenceClassification for predictions without further training.
</code></pre>
</div>
</div>
<div class="cell markdown" id="f1yBlnaWkmrN">
<p><br></p>
<h4 id="모델-평가">모델 평가</h4>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="S0M14K9p6Dj8" data-outputId="57dc705d-ba9f-4195-ae99-31c28648d33d">
<div class="sourceCode" id="cb187"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>text_classifier(<span class="st">&#39;뭐야 이 평점들은.... 나쁘진 않지만 10점 짜리는 더더욱 아니잖아&#39;</span>)[<span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<pre><code>[{&#39;label&#39;: &#39;LABEL_0&#39;, &#39;score&#39;: 0.746947169303894},
 {&#39;label&#39;: &#39;LABEL_1&#39;, &#39;score&#39;: 0.25305283069610596}]</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="EabotRgy6Dj8" data-outputId="6aff56d3-d24d-448d-c414-f6e18b3bf6cd">
<div class="sourceCode" id="cb189"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>text_classifier(<span class="st">&#39;오랜만에 평점 로긴했네ㅋㅋ 킹왕짱 쌈뽕한 영화를 만났습니다 강렬하게 육쾌함&#39;</span>)[<span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<pre><code>[{&#39;label&#39;: &#39;LABEL_0&#39;, &#39;score&#39;: 0.08093070983886719},
 {&#39;label&#39;: &#39;LABEL_1&#39;, &#39;score&#39;: 0.9190692901611328}]</code></pre>
</div>
</div>
<div class="cell markdown" id="vKtw5-3ObxPH">
<p><br></p>
<h2 id="kornli-다중-클래스-분류">KorNLI (다중 클래스 분류)</h2>
<ul>
<li><strong>NLI는 두 개의 문장이 주어지면 수반(entailment) 관계인지,
모순(contradiction) 관계인지, 중립(neutral) 관계인지를 맞추는
문제</strong></li>
</ul>
</div>
<div class="cell code" data-execution_count="1"
data-executionInfo="{&quot;elapsed&quot;:33024,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020604079,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="1ikvjFZmUpTX">
<div class="sourceCode" id="cb191"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> BertTokenizer, TFBertModel</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping, ModelCheckpoint</span></code></pre></div>
</div>
<div class="cell markdown" id="ke0g5W_6lp9Q">
<p><br></p>
<h4 id="데이터-로드">데이터 로드</h4>
<ul>
<li>훈련 데이터</li>
</ul>
</div>
<div class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1630,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020605699,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Lg-WpyefVt6f" data-outputId="54460df8-da43-43c2-deef-b139484dd37d">
<div class="sourceCode" id="cb192"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/kakaobrain/KorNLUDatasets/master/KorNLI/multinli.train.ko.tsv&quot;</span>, filename<span class="op">=</span><span class="st">&quot;multinli.train.ko.tsv&quot;</span>)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/kakaobrain/KorNLUDatasets/master/KorNLI/snli_1.0_train.ko.tsv&quot;</span>, filename<span class="op">=</span><span class="st">&quot;snli_1.0_train.ko.tsv&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<pre><code>(&#39;snli_1.0_train.ko.tsv&#39;, &lt;http.client.HTTPMessage at 0x7d18b7e6e3e0&gt;)</code></pre>
</div>
</div>
<div class="cell markdown" id="gFJp6XMPlwtL">
<ul>
<li>검증 데이터</li>
</ul>
</div>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020606007,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="hP58ScgpWKib" data-outputId="e4429bcf-f558-470a-dd81-21aa2e226445">
<div class="sourceCode" id="cb194"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/kakaobrain/KorNLUDatasets/master/KorNLI/xnli.dev.ko.tsv&quot;</span>, filename<span class="op">=</span><span class="st">&quot;xnli.dev.ko.tsv&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<pre><code>(&#39;xnli.dev.ko.tsv&#39;, &lt;http.client.HTTPMessage at 0x7d18b7e6e320&gt;)</code></pre>
</div>
</div>
<div class="cell markdown" id="_a0pmAk4lxo-">
<ul>
<li>평가 데이터</li>
</ul>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020606008,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="CC3siSaKaLlo" data-outputId="d98ad9c9-7526-49e7-98a9-7d856a77d5a4">
<div class="sourceCode" id="cb196"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">&quot;https://raw.githubusercontent.com/kakaobrain/KorNLUDatasets/master/KorNLI/xnli.test.ko.tsv&quot;</span>, filename<span class="op">=</span><span class="st">&quot;xnli.test.ko.tsv&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<pre><code>(&#39;xnli.test.ko.tsv&#39;, &lt;http.client.HTTPMessage at 0x7d18b7e6e680&gt;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5"
data-executionInfo="{&quot;elapsed&quot;:6906,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020612912,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="wIocqZUdWTcK">
<div class="sourceCode" id="cb198"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>train_snli <span class="op">=</span> pd.read_csv(<span class="st">&quot;snli_1.0_train.ko.tsv&quot;</span>, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, quoting<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>train_xnli <span class="op">=</span> pd.read_csv(<span class="st">&quot;multinli.train.ko.tsv&quot;</span>, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, quoting<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> pd.read_csv(<span class="st">&quot;xnli.dev.ko.tsv&quot;</span>, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, quoting<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_csv(<span class="st">&quot;xnli.test.ko.tsv&quot;</span>, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, quoting<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:12,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020612912,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Eqo4MV2SLQ0v" data-outputId="86c75c20-7aa8-4015-e19c-ba8f93a27a1a">
<div class="sourceCode" id="cb199"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>train_snli.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">

  <div id="df-e1299f2e-6daf-4def-8f47-3501fbfae9a8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence1</th>
      <th>sentence2</th>
      <th>gold_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>말을 탄 사람이 고장난 비행기 위로 뛰어오른다.</td>
      <td>한 사람이 경쟁을 위해 말을 훈련시키고 있다.</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>1</th>
      <td>말을 탄 사람이 고장난 비행기 위로 뛰어오른다.</td>
      <td>한 사람이 식당에서 오믈렛을 주문하고 있다.</td>
      <td>contradiction</td>
    </tr>
    <tr>
      <th>2</th>
      <td>말을 탄 사람이 고장난 비행기 위로 뛰어오른다.</td>
      <td>사람은 야외에서 말을 타고 있다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>3</th>
      <td>카메라에 웃고 손을 흔드는 아이들</td>
      <td>그들은 부모님을 보고 웃고 있다</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>4</th>
      <td>카메라에 웃고 손을 흔드는 아이들</td>
      <td>아이들이 있다</td>
      <td>entailment</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e1299f2e-6daf-4def-8f47-3501fbfae9a8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e1299f2e-6daf-4def-8f47-3501fbfae9a8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e1299f2e-6daf-4def-8f47-3501fbfae9a8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e5f8c3d0-e3ad-4ff4-88c0-b567623ce27c">
  <button class="colab-df-quickchart" onclick="quickchart('df-e5f8c3d0-e3ad-4ff4-88c0-b567623ce27c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e5f8c3d0-e3ad-4ff4-88c0-b567623ce27c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:276}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020612913,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="kWn1mUBLLSf8" data-outputId="69c8bb95-fadb-4a95-c117-e8621a8a2958">
<div class="sourceCode" id="cb200"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>train_xnli.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

  <div id="df-f2f63b1c-d932-423d-a790-4f9e695479fb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence1</th>
      <th>sentence2</th>
      <th>gold_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>개념적으로 크림 스키밍은 제품과 지리라는 두 가지 기본 차원을 가지고 있다.</td>
      <td>제품과 지리학은 크림 스키밍을 작동시키는 것이다.</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>1</th>
      <td>시즌 중에 알고 있는 거 알아? 네 레벨에서 다음 레벨로 잃어버리는 거야 브레이브스...</td>
      <td>사람들이 기억하면 다음 수준으로 물건을 잃는다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>2</th>
      <td>우리 번호 중 하나가 당신의 지시를 세밀하게 수행할 것이다.</td>
      <td>우리 팀의 일원이 당신의 명령을 엄청나게 정확하게 실행할 것이다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>3</th>
      <td>어떻게 아세요? 이 모든 것이 다시 그들의 정보다.</td>
      <td>이 정보는 그들의 것이다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>4</th>
      <td>그래, 만약 네가 테니스화 몇 개를 사러 간다면, 나는 왜 그들이 100달러대에서 ...</td>
      <td>테니스화의 가격은 다양하다.</td>
      <td>neutral</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f2f63b1c-d932-423d-a790-4f9e695479fb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f2f63b1c-d932-423d-a790-4f9e695479fb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f2f63b1c-d932-423d-a790-4f9e695479fb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4d3fd8f5-9b98-4575-8f90-8ff358733262">
  <button class="colab-df-quickchart" onclick="quickchart('df-4d3fd8f5-9b98-4575-8f90-8ff358733262')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4d3fd8f5-9b98-4575-8f90-8ff358733262 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="XYpW2PoVl3lW">
<ul>
<li>훈련 데이터 결합 후 섞기</li>
</ul>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1501,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020614410,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="eNiGlEMZWl82" data-outputId="4557e849-e54d-41e1-906a-93d41c86138f">
<div class="sourceCode" id="cb201"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_snli.append(train_xnli)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> train_data.sample(frac<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-8-106fa8c3e2e3&gt;:1: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  train_data = train_snli.append(train_xnli)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:293}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020614410,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="t-Gag3yFLiRM" data-outputId="1753831c-e461-49f7-8020-087b01631992">
<div class="sourceCode" id="cb203"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>train_data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-5994bb76-7592-4d83-a262-b79f42b4701a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence1</th>
      <th>sentence2</th>
      <th>gold_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>185169</th>
      <td>오토바이를 탄 두 남자가 빈 거리를 운전하고 있다.</td>
      <td>두 남자가 오토바이를 운전하고 있다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>502149</th>
      <td>파란 유니폼을 입은 여자가 서서 아래를 내려다본다.</td>
      <td>여자가 일하고 있다.</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>132107</th>
      <td>한 무리의 인도 남성들은 3명의 학교 아이들, 한 명의 어린 소년, 그리고 두 명의...</td>
      <td>아무도 자고 있지 않다</td>
      <td>contradiction</td>
    </tr>
    <tr>
      <th>273713</th>
      <td>피어싱과 목걸이, 옥수수를 머리에 이고 있는 아프리카 여성.</td>
      <td>그 아프리카 여성은 머리에 호박을 가지고 있다.</td>
      <td>contradiction</td>
    </tr>
    <tr>
      <th>277777</th>
      <td>베르겐 카운티 법률 서비스 책임자로서 400만 달러의 예산이 3군청 부국장이 된다.</td>
      <td>3개 카운티 사무소의 예산은 베르겐 카운티 서비스의 예산보다 거의 두 배나 크다.</td>
      <td>neutral</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5994bb76-7592-4d83-a262-b79f42b4701a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5994bb76-7592-4d83-a262-b79f42b4701a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5994bb76-7592-4d83-a262-b79f42b4701a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-796a5d94-0b98-4816-9c7d-232ad075a319">
  <button class="colab-df-quickchart" onclick="quickchart('df-796a5d94-0b98-4816-9c7d-232ad075a319')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-796a5d94-0b98-4816-9c7d-232ad075a319 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:258}"
data-executionInfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020614410,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Z0VfKZgXLTvL" data-outputId="94fc2805-cde9-49fc-b4e0-390b19a76f12">
<div class="sourceCode" id="cb204"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>val_data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-7e3bcd9c-2244-459b-be1c-2fc9c2369e4a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence1</th>
      <th>sentence2</th>
      <th>gold_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>그리고 그가 말했다, "엄마, 저 왔어요."</td>
      <td>그는 학교 버스가 그를 내려주자마자 엄마에게 전화를 걸었다.</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>1</th>
      <td>그리고 그가 말했다, "엄마, 저 왔어요."</td>
      <td>그는 한마디도 하지 않았다.</td>
      <td>contradiction</td>
    </tr>
    <tr>
      <th>2</th>
      <td>그리고 그가 말했다, "엄마, 저 왔어요."</td>
      <td>그는 엄마에게 집에 갔다고 말했다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>3</th>
      <td>내가 무엇을 위해 가고 있는지 또는 어떤 것을 위해 있는지 몰랐기 때문에 워싱턴의 ...</td>
      <td>나는 워싱턴에 가본 적이 없어서 거기 배정을 받았을 때 그 장소를 찾으려다가 길을 ...</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>4</th>
      <td>내가 무엇을 위해 가고 있는지 또는 어떤 것을 위해 있는지 몰랐기 때문에 워싱턴의 ...</td>
      <td>워싱턴으로 진군하면서 해야 할 일이 무엇인지 정확히 알고 있었다.</td>
      <td>contradiction</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7e3bcd9c-2244-459b-be1c-2fc9c2369e4a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7e3bcd9c-2244-459b-be1c-2fc9c2369e4a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7e3bcd9c-2244-459b-be1c-2fc9c2369e4a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c3209976-4821-419c-9f3f-49faaa6abb8c">
  <button class="colab-df-quickchart" onclick="quickchart('df-c3209976-4821-419c-9f3f-49faaa6abb8c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c3209976-4821-419c-9f3f-49faaa6abb8c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:293}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020614410,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="YgSoABjhLUoQ" data-outputId="48da8d91-fdae-48d5-f4bd-0f4f5daf52e8">
<div class="sourceCode" id="cb205"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>test_data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">

  <div id="df-af102361-c3dd-4c11-aaa0-582fa51e15a0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence1</th>
      <th>sentence2</th>
      <th>gold_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>글쎄, 나는 그것에 관해 생각조차 하지 않았지만, 나는 너무 좌절했고, 결국 그에게...</td>
      <td>나는 그와 다시 이야기하지 않았다.</td>
      <td>contradiction</td>
    </tr>
    <tr>
      <th>1</th>
      <td>글쎄, 나는 그것에 관해 생각조차 하지 않았지만, 나는 너무 좌절했고, 결국 그에게...</td>
      <td>나는 다시 그와 이야기를 하기 시작했다는 것에 너무 화가 났다.</td>
      <td>entailment</td>
    </tr>
    <tr>
      <th>2</th>
      <td>글쎄, 나는 그것에 관해 생각조차 하지 않았지만, 나는 너무 좌절했고, 결국 그에게...</td>
      <td>우리는 좋은 대화를 나눴다.</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>3</th>
      <td>그리고 저는 그것이 특권이라고 생각했습니다, 그리고 여전히, 여전히, 당시 저는 A...</td>
      <td>그날 현장에 나만 있었던 게 아니라는 걸 몰랐던 것이다.</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>4</th>
      <td>그리고 저는 그것이 특권이라고 생각했습니다, 그리고 여전히, 여전히, 당시 저는 A...</td>
      <td>나는 AFFC 공군 경력 분야에서 그 번호를 가진 유일한 사람이라는 인상을 가지고 ...</td>
      <td>entailment</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-af102361-c3dd-4c11-aaa0-582fa51e15a0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-af102361-c3dd-4c11-aaa0-582fa51e15a0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-af102361-c3dd-4c11-aaa0-582fa51e15a0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6ce21de3-099f-439d-89fc-373cb5208577">
  <button class="colab-df-quickchart" onclick="quickchart('df-6ce21de3-099f-439d-89fc-373cb5208577')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6ce21de3-099f-439d-89fc-373cb5208577 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="nrU6uK9BmDMg">
<p><br></p>
<h4 id="데이터-정제">데이터 정제</h4>
<ul>
<li>결측값 및 중복값 제거</li>
</ul>
</div>
<div class="cell code" data-execution_count="12"
data-executionInfo="{&quot;elapsed&quot;:534,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020614939,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="TQ1Lojbad9c1">
<div class="sourceCode" id="cb206"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> drop_na_and_duplciates(df):</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df.dropna()</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df.drop_duplicates()</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="13"
data-executionInfo="{&quot;elapsed&quot;:7380,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020622317,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="1p6ph7f_eNXj">
<div class="sourceCode" id="cb207"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> drop_na_and_duplciates(train_data)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> drop_na_and_duplciates(val_data)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> drop_na_and_duplciates(test_data)</span></code></pre></div>
</div>
<div class="cell markdown" id="rmeJvauBmJBD">
<p><br></p>
<h4 id="kobert-토큰화">KoBERT 토큰화</h4>
</div>
<div class="cell markdown" id="ZgItt6G5mLxL">
<ul>
<li>모델 로드</li>
</ul>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1704,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020625708,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="gBeJvV8ZWu_8" data-outputId="c0d6ac46-61ee-4474-c9a3-8e521d4b3f77">
<div class="sourceCode" id="cb208"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> BertTokenizer.from_pretrained(<span class="st">&quot;klue/bert-base&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
</code></pre>
</div>
</div>
<div class="cell markdown" id="BGEMGHPZmTuP">
<ul>
<li>문장 최대 길이</li>
</ul>
</div>
<div class="cell code" data-execution_count="15"
data-executionInfo="{&quot;elapsed&quot;:278,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020627936,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="wpekSoSxvgqf">
<div class="sourceCode" id="cb210"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>max_seq_len <span class="op">=</span> <span class="dv">128</span></span></code></pre></div>
</div>
<div class="cell markdown" id="zJMIKdaLmU17">
<ul>
<li>2개의 입력 문장에 대한 어텐션 마스킹 &amp; 세그먼트 임베딩</li>
</ul>
</div>
<div class="cell code" data-execution_count="16"
data-executionInfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708020628339,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="MqDH6oL_q7M7">
<div class="sourceCode" id="cb211"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_examples_to_features(sent_list1, sent_list2, max_seq_len, tokenizer):</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>    input_ids, attention_masks, token_type_ids <span class="op">=</span> [], [], []</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sent1, sent2 <span class="kw">in</span> tqdm(<span class="bu">zip</span>(sent_list1, sent_list2), total<span class="op">=</span><span class="bu">len</span>(sent_list1)):</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>        encoding_result <span class="op">=</span> tokenizer.encode_plus(sent1, sent2, max_length<span class="op">=</span>max_seq_len, pad_to_max_length<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>        input_ids.append(encoding_result[<span class="st">&#39;input_ids&#39;</span>])</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>        attention_masks.append(encoding_result[<span class="st">&#39;attention_mask&#39;</span>])</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>        token_type_ids.append(encoding_result[<span class="st">&#39;token_type_ids&#39;</span>])</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> np.array(input_ids, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>    attention_masks <span class="op">=</span> np.array(attention_masks, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>    token_type_ids <span class="op">=</span> np.array(token_type_ids, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (input_ids, attention_masks, token_type_ids)</span></code></pre></div>
</div>
<div class="cell code" id="GEypgF_hvZOa">
<div class="sourceCode" id="cb212"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> convert_examples_to_features(train_data[<span class="st">&#39;sentence1&#39;</span>], train_data[<span class="st">&#39;sentence2&#39;</span>], max_seq_len<span class="op">=</span>max_seq_len, tokenizer<span class="op">=</span>tokenizer)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021426837,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="nsNazdJZT08K" data-outputId="4460da8c-4247-4f68-d409-935ca3c3be21">
<div class="sourceCode" id="cb213"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>input_id <span class="op">=</span> X_train[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>attention_mask <span class="op">=</span> X_train[<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>token_type_id <span class="op">=</span> X_train[<span class="dv">2</span>][<span class="dv">0</span>]</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;단어에 대한 정수 인코딩 :&#39;</span>,input_id)</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;어텐션 마스크 :&#39;</span>,attention_mask)</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;세그먼트 인코딩 :&#39;</span>,token_type_id)</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;각 인코딩의 길이 :&#39;</span>, <span class="bu">len</span>(input_id))</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;정수 인코딩 복원 :&#39;</span>,tokenizer.decode(input_id))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>단어에 대한 정수 인코딩 : [    2 12406  2138  1763   864  3997  2116  1189  4142  2138  5390 19521
  1513  2062    18     3   864  3997  2116 12406  2138  5390 19521  1513
  2062    18     3     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0]
어텐션 마스크 : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
세그먼트 인코딩 : [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
각 인코딩의 길이 : 128
정수 인코딩 복원 : [CLS] 오토바이를 탄 두 남자가 빈 거리를 운전하고 있다. [SEP] 두 남자가 오토바이를 운전하고 있다. [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1446,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021428280,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="AyHLx5wvUQkC" data-outputId="5e132534-f387-447a-c709-87d686c5db4c">
<div class="sourceCode" id="cb215"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> convert_examples_to_features(val_data[<span class="st">&#39;sentence1&#39;</span>], val_data[<span class="st">&#39;sentence2&#39;</span>], max_seq_len<span class="op">=</span>max_seq_len, tokenizer<span class="op">=</span>tokenizer)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 2490/2490 [00:01&lt;00:00, 1720.72it/s]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:0,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021428299,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="MwtDuu8TUaYC" data-outputId="c613e861-e862-46b4-ab62-638920c4be53">
<div class="sourceCode" id="cb217"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최대 길이: 128</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>input_id <span class="op">=</span> X_val[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>attention_mask <span class="op">=</span> X_val[<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>token_type_id <span class="op">=</span> X_val[<span class="dv">2</span>][<span class="dv">0</span>]</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;단어에 대한 정수 인코딩 :&#39;</span>,input_id)</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;어텐션 마스크 :&#39;</span>,attention_mask)</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;세그먼트 인코딩 :&#39;</span>,token_type_id)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;각 인코딩의 길이 :&#39;</span>, <span class="bu">len</span>(input_id))</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;정수 인코딩 복원 :&#39;</span>,tokenizer.decode(input_id))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>단어에 대한 정수 인코딩 : [    2  3673   636  2116  1041  2371  2062    16     6  4122    16  1535
  1458 10283    18     6     3   636  2259  3741  4942  2116   636  2138
  4105  2223  2155  6000  4122  2170  2318  4117  2138   572  2359  2062
    18     3     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0]
어텐션 마스크 : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
세그먼트 인코딩 : [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
각 인코딩의 길이 : 128
정수 인코딩 복원 : [CLS] 그리고 그가 말했다, &quot; 엄마, 저 왔어요. &quot; [SEP] 그는 학교 버스가 그를 내려주자마자 엄마에게 전화를 걸었다. [SEP] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3009,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021431309,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="X24uJmbV81gJ" data-outputId="fe348f41-10aa-43f7-a8ae-a4de0785ccf1">
<div class="sourceCode" id="cb219"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> convert_examples_to_features(test_data[<span class="st">&#39;sentence1&#39;</span>], test_data[<span class="st">&#39;sentence2&#39;</span>], max_seq_len<span class="op">=</span>max_seq_len, tokenizer<span class="op">=</span>tokenizer)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 5010/5010 [00:02&lt;00:00, 1747.58it/s]
</code></pre>
</div>
</div>
<div class="cell markdown" id="3pS6say3mqr4">
<p><br></p>
<h4 id="타겟-라벨-인코딩">타겟 라벨 인코딩</h4>
<ul>
<li><p><strong>타겟 (2개의 문장간 관계)가 수반(entailment)일 시
1,</strong></p>
<p><strong>모순(contradiction)관계일 시 0,</strong></p>
<p><strong>중립(neutral)관계일 시 2로 라벨 인코딩</strong></p></li>
</ul>
</div>
<div class="cell code" data-execution_count="22"
data-executionInfo="{&quot;elapsed&quot;:487,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021431796,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="HD1rwfoiWHaC">
<div class="sourceCode" id="cb221"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>train_label <span class="op">=</span> train_data[<span class="st">&#39;gold_label&#39;</span>].tolist()</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>val_label <span class="op">=</span> val_data[<span class="st">&#39;gold_label&#39;</span>].tolist()</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>test_label <span class="op">=</span> test_data[<span class="st">&#39;gold_label&#39;</span>].tolist()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:966,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021432762,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="3SLFnBHrWjwg" data-outputId="6d5a2e9e-f938-4f41-fdde-b183c2cd1837">
<div class="sourceCode" id="cb222"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>idx_encode <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>idx_encode.fit(train_label)</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> idx_encode.transform(train_label)</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>y_val <span class="op">=</span> idx_encode.transform(val_label)</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> idx_encode.transform(test_label)</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>label_idx <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(<span class="bu">list</span>(idx_encode.classes_), idx_encode.transform(<span class="bu">list</span>(idx_encode.classes_))))</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>idx_label <span class="op">=</span> {value: key <span class="cf">for</span> key, value <span class="kw">in</span> label_idx.items()}</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(label_idx)</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(idx_label)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;contradiction&#39;: 0, &#39;entailment&#39;: 1, &#39;neutral&#39;: 2}
{0: &#39;contradiction&#39;, 1: &#39;entailment&#39;, 2: &#39;neutral&#39;}
</code></pre>
</div>
</div>
<div class="cell markdown" id="GedwZgr9nfM1">
<p><br></p>
<h4 id="tpu-설정-하에서의-모델-생성">TPU 설정 하에서의 모델 생성</h4>
</div>
<div class="cell markdown" id="HtAdB7Phnl-j">
<ul>
<li>TPU 구동</li>
</ul>
</div>
<div class="cell code" data-execution_count="24"
data-executionInfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1708021432763,&quot;user&quot;:{&quot;displayName&quot;:&quot;Chansol Lee&quot;,&quot;userId&quot;:&quot;05241681837433185221&quot;},&quot;user_tz&quot;:-540}"
id="Sphj4kwtIFgm">
<div class="sourceCode" id="cb224"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> TFBertForSequenceClassification</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8oLYvFfzBS_H" data-outputId="9497a355-4ef2-40c5-9f57-9521b370c66e">
<div class="sourceCode" id="cb225"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>resolver <span class="op">=</span> tf.distribute.cluster_resolver.TPUClusterResolver(tpu<span class="op">=</span><span class="st">&#39;grpc://&#39;</span> <span class="op">+</span> os.environ[<span class="st">&#39;COLAB_TPU_ADDR&#39;</span>])</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>tf.config.experimental_connect_to_cluster(resolver)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>tf.tpu.experimental.initialize_tpu_system(resolver)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>INFO:tensorflow:Deallocate tpu buffers before initializing tpu system.
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>INFO:tensorflow:Deallocate tpu buffers before initializing tpu system.
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>WARNING:tensorflow:TPU system grpc://10.59.221.170:8470 has already been initialized. Reinitializing the TPU can cause previously created variables on TPU to be lost.
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING:tensorflow:TPU system grpc://10.59.221.170:8470 has already been initialized. Reinitializing the TPU can cause previously created variables on TPU to be lost.
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>INFO:tensorflow:Initializing the TPU system: grpc://10.59.221.170:8470
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>INFO:tensorflow:Initializing the TPU system: grpc://10.59.221.170:8470
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>INFO:tensorflow:Finished initializing TPU system.
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>INFO:tensorflow:Finished initializing TPU system.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="45">
<pre><code>&lt;tensorflow.python.tpu.topology.Topology at 0x7f3c9aabb590&gt;</code></pre>
</div>
</div>
<div class="cell code" id="amxUmS4PgVah">
<div class="sourceCode" id="cb235"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>strategy <span class="op">=</span> tf.distribute.experimental.TPUStrategy(resolver)</span></code></pre></div>
</div>
<div class="cell markdown" id="fRC8DreLnoTz">
<p><br></p>
<ul>
<li>모델 생성 및 컴파일</li>
</ul>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="y6HZ6rspBVxt" data-outputId="70fae873-5d99-4b33-e562-c151972443e5">
<div class="sourceCode" id="cb236"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> strategy.scope():</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> TFBertForSequenceClassification.from_pretrained(<span class="st">&quot;klue/bert-base&quot;</span>, num_labels<span class="op">=</span><span class="dv">3</span>, from_pt<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  optimizer <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">5e-5</span>)</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  model.<span class="bu">compile</span>(optimizer<span class="op">=</span>optimizer, loss<span class="op">=</span>model.hf_compute_loss, metrics <span class="op">=</span> [<span class="st">&#39;accuracy&#39;</span>])</span></code></pre></div>
<div class="output stream stderr">
<pre><code>Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBertForSequenceClassification: [&#39;bert.embeddings.position_ids&#39;]
- This IS expected if you are initializing TFBertForSequenceClassification from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertForSequenceClassification from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).
Some weights or buffers of the TF 2.0 model TFBertForSequenceClassification were not initialized from the PyTorch model and are newly initialized: [&#39;classifier.weight&#39;, &#39;classifier.bias&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</code></pre>
</div>
</div>
<div class="cell markdown" id="NIoT3pqHnq0M">
<p><br></p>
<h4 id="모델-적합-및-평가">모델 적합 및 평가</h4>
<ul>
<li>조기 종료 옵션 설정</li>
</ul>
</div>
<div class="cell code" id="s1k5ylJFgquc">
<div class="sourceCode" id="cb238"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">&quot;val_accuracy&quot;</span>,</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    min_delta<span class="op">=</span><span class="fl">0.001</span>,</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>    patience<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BqN2Pa9sBZTy" data-outputId="827ee6bd-0c42-4f66-d852-19f350cfbdd7">
<div class="sourceCode" id="cb239"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>model.fit(</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>    X_train, y_train, epochs<span class="op">=</span><span class="dv">2</span>, batch_size<span class="op">=</span><span class="dv">32</span>, validation_data <span class="op">=</span> (X_val, y_val),</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>    callbacks <span class="op">=</span> [early_stopping]</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/2
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>INFO:absl:TPU has inputs with dynamic shapes: [&lt;tf.Tensor &#39;Const:0&#39; shape=() dtype=int32&gt;, &lt;tf.Tensor &#39;cond/Identity:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_8:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_16:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_24:0&#39; shape=(None,) dtype=int64&gt;]
INFO:absl:TPU has inputs with dynamic shapes: [&lt;tf.Tensor &#39;Const:0&#39; shape=() dtype=int32&gt;, &lt;tf.Tensor &#39;cond/Identity:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_8:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_16:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_24:0&#39; shape=(None,) dtype=int64&gt;]
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>29432/29432 [==============================] - ETA: 0s - loss: 0.5343 - accuracy: 0.7874</code></pre>
</div>
<div class="output stream stderr">
<pre><code>INFO:absl:TPU has inputs with dynamic shapes: [&lt;tf.Tensor &#39;Const:0&#39; shape=() dtype=int32&gt;, &lt;tf.Tensor &#39;cond/Identity:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_8:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_16:0&#39; shape=(None, 128) dtype=int64&gt;, &lt;tf.Tensor &#39;cond/Identity_24:0&#39; shape=(None,) dtype=int64&gt;]
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>29432/29432 [==============================] - 2321s 76ms/step - loss: 0.5343 - accuracy: 0.7874 - val_loss: 0.5494 - val_accuracy: 0.7711
Epoch 2/2
29432/29432 [==============================] - 2181s 74ms/step - loss: 0.4352 - accuracy: 0.8329 - val_loss: 0.5446 - val_accuracy: 0.7831
</code></pre>
</div>
<div class="output execute_result" data-execution_count="49">
<pre><code>&lt;keras.callbacks.History at 0x7f3c98176f10&gt;</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="0H4rWb-FBZT3" data-outputId="cc271c09-8c27-4191-e349-9cdaa720ef60">
<div class="sourceCode" id="cb246"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 테스트 정확도: </span><span class="sc">%.4f</span><span class="st">&quot;</span> <span class="op">%</span> (model.evaluate(X_test, y_test, batch_size<span class="op">=</span><span class="dv">1024</span>)[<span class="dv">1</span>]))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>5/5 [==============================] - 19s 2s/step - loss: 0.5414 - accuracy: 0.7749

 테스트 정확도: 0.7749
</code></pre>
</div>
</div>
</body>
</html>
